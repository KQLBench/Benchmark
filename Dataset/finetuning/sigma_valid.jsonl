{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential DLL sideloading of \"edputil.dll\" Topic: image_load_side_load_edputil"}, {"role": "assistant", "content": "DeviceImageLoadEvents\n| where FolderPath endswith \"\\\\edputil.dll\" and (not((FolderPath startswith \"C:\\\\Windows\\\\System32\\\\\" or FolderPath startswith \"C:\\\\Windows\\\\SysWOW64\\\\\" or FolderPath startswith \"C\\\\Windows\\\\WinSxS\\\\\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential commandline obfuscation using known escape characters Topic: proc_creation_win_susp_cli_obfuscation_escape_char"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"h^t^t^p\", \"h\\\"t\\\"t\\\"p\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of \"ebpfbackdoor\" files in both \"cron.d\" and \"sudoers.d\" directories. Which both are related to the TripleCross persistence method Topic: file_event_lnx_triple_cross_rootkit_persistence"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \"ebpfbackdoor\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of the LiveKD driver by a process image other than \"livekd.exe\". Topic: file_event_win_sysinternals_livekd_driver_susp_creation"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \"C:\\\\Windows\\\\System32\\\\drivers\\\\LiveKdD.SYS\" and (not((InitiatingProcessFolderPath in~ (\"\\\\livekd.exe\", \"\\\\livek64.exe\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects calls of DLLs exports by ordinal numbers via rundll32.dll. Topic: proc_creation_win_rundll32_by_ordinal"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine in~ (\",#\", \", #\", \".dll #\", \".ocx #\")) and (FolderPath endswith \"\\\\rundll32.exe\" or ProcessVersionInfoOriginalFileName =~ \"RUNDLL32.EXE\")) and (not(((ProcessCommandLine in~ (\"EDGEHTML.dll\", \"#141\")) or ((InitiatingProcessFileName in~ (\"\\\\Msbuild\\\\Current\\\\Bin\\\\\", \"\\\\VC\\\\Tools\\\\MSVC\\\\\", \"\\\\Tracker.exe\")) and (ProcessCommandLine in~ (\"\\\\FileTracker32.dll,#1\", \"\\\\FileTracker32.dll\\\",#1\", \"\\\\FileTracker64.dll,#1\", \"\\\\FileTracker64.dll\\\",#1\"))))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects usage of \"IMEWDBLD.exe\" to download arbitrary files Topic: proc_creation_win_imewbdld_download"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"http://\", \"https://\")) and (FolderPath endswith \"\\\\IMEWDBLD.exe\" or ProcessVersionInfoOriginalFileName =~ \"imewdbld.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious use of calc.exe with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion.\n Topic: proc_creation_win_calc_uncommon_exec"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"\\\\calc.exe \" or (InitiatingProcessFolderPath =~ \"\\\\calc.exe\" and (not((FolderPath contains \":\\\\Windows\\\\System32\\\\\" or FolderPath contains \":\\\\Windows\\\\SysWOW64\\\\\" or FolderPath contains \":\\\\Windows\\\\WinSxS\\\\\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line Topic: proc_creation_win_powershell_susp_ps_downloadfile"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"powershell\", \".DownloadFile\", \"System.Net.WebClient\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects usage of the \"usermod\" binary to add users add users to the root or suoders groups Topic: proc_creation_lnx_usermod_susp_group"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"-aG root\", \"-aG sudoers\")) and InitiatingProcessFolderPath =~ \"/usermod\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects attackers attempting to disable Windows Defender using Powershell Topic: proc_creation_win_powershell_disable_defender_av_security_monitoring"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (((FolderPath endswith \"\\\\powershell.exe\" or FolderPath endswith \"\\\\pwsh.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"PowerShell.EXE\", \"pwsh.dll\"))) and (ProcessCommandLine in~ (\"-DisableBehaviorMonitoring $true\", \"-DisableRuntimeMonitoring $true\"))) or ((FolderPath endswith \"\\\\sc.exe\" or ProcessVersionInfoOriginalFileName =~ \"sc.exe\") and ((ProcessCommandLine in~ (\"delete\", \"WinDefend\")) or (ProcessCommandLine in~ (\"config\", \"WinDefend\", \"start=disabled\")) or (ProcessCommandLine in~ (\"stop\", \"WinDefend\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects specific command line execution used by FIN7 as reported by WithSecureLabs for reconnaissance and POWERTRASH execution Topic: proc_creation_win_apt_fin7_powertrash_lateral_movement"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"-noni -nop -exe bypass -f \\\\\\\\\", \"ADMIN$\")) or (ProcessCommandLine in~ (\"-ex bypass -noprof -nolog -nonint -f\", \"C:\\\\Windows\\\\Temp\\\\\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects sideloading of trojanized DLLs used in Lazarus APT campaign in the case of a Spanish aerospace company Topic: image_load_apt_lazarus_side_load_activity"}, {"role": "assistant", "content": "DeviceImageLoadEvents\n| where (InitiatingProcessFolderPath =~ \"C:\\\\ProgramShared\\\\PresentationHost.exe\" and FolderPath =~ \":\\\\ProgramShared\\\\mscoree.dll\") or (InitiatingProcessFolderPath =~ \"C:\\\\ProgramData\\\\Adobe\\\\colorcpl.exe\" and FolderPath =~ \"C:\\\\ProgramData\\\\Adobe\\\\colorui.dll\") or (InitiatingProcessFolderPath =~ \"C:\\\\ProgramData\\\\Oracle\\\\Java\\\\fixmapi.exe\" and FolderPath =~ \"C:\\\\ProgramData\\\\Oracle\\\\Java\\\\mapistub.dll\") or (InitiatingProcessFolderPath =~ \"C:\\\\ProgramData\\\\Adobe\\\\ARM\\\\tabcal.exe\" and FolderPath =~ \"C:\\\\ProgramData\\\\Adobe\\\\ARM\\\\HID.dll\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "This detection uses Windows security events to detect suspicious access attempts to the registry key of Azure AD Health monitoring agent.\nThis detection requires an access control entry (ACE) on the system access control list (SACL) of the following securable object HKLM\\SOFTWARE\\Microsoft\\Microsoft Online\\Reporting\\MonitoringAgent.\n Topic: win_security_aadhealth_mon_agent_regkey_access"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey =~ \"\\\\REGISTRY\\\\MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Microsoft Online\\\\Reporting\\\\MonitoringAgent\" and (not((InitiatingProcessFolderPath contains \"Microsoft.Identity.Health.Adfs.DiagnosticsAgent.exe\" or InitiatingProcessFolderPath contains \"Microsoft.Identity.Health.Adfs.InsightsService.exe\" or InitiatingProcessFolderPath contains \"Microsoft.Identity.Health.Adfs.MonitoringAgent.Startup.exe\" or InitiatingProcessFolderPath contains \"Microsoft.Identity.Health.Adfs.PshSurrogate.exe\" or InitiatingProcessFolderPath contains \"Microsoft.Identity.Health.Common.Clients.ResourceMonitor.exe\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of files with an \"LNK\" as a second extension. This is sometimes used by malware as a method to abuse the fact that Windows hides the \"LNK\" extension by default.\n Topic: file_event_win_susp_lnk_double_extension"}, {"role": "assistant", "content": "DeviceFileEvents\n| where (FileName in~ (\".doc.\", \".docx.\", \".jpg.\", \".pdf.\", \".ppt.\", \".pptx.\", \".xls.\", \".xlsx.\")) and (not(FileName =~ \"\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Recent\\\\\")) and (not(((FileName =~ \"\\\\AppData\\\\Roaming\\\\Microsoft\\\\Excel\" and InitiatingProcessFolderPath =~ \"\\\\excel.exe\") or (FileName =~ \"\\\\AppData\\\\Roaming\\\\Microsoft\\\\PowerPoint\" and InitiatingProcessFolderPath =~ \"\\\\powerpnt.exe\") or (FileName =~ \"\\\\AppData\\\\Roaming\\\\Microsoft\\\\Office\\\\Recent\\\\\" and (InitiatingProcessFolderPath in~ (\"\\\\excel.exe\", \"\\\\powerpnt.exe\", \"\\\\winword.exe\"))) or (FileName =~ \"\\\\AppData\\\\Roaming\\\\Microsoft\\\\Word\" and InitiatingProcessFolderPath =~ \"\\\\winword.exe\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects usage of the \"FromBase64String\" function in the commandline which is used to decode a base64 encoded string Topic: proc_creation_win_powershell_frombase64string"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"::FromBase64String(\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32) Topic: registry_set_uac_bypass_wmp"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey endswith \"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\Compatibility Assistant\\\\Store\\\\C:\\\\Program Files\\\\Windows Media Player\\\\osk.exe\" and RegistryValueData =~ \"Binary Data\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious encoded character syntax often used for defense evasion Topic: proc_creation_win_powershell_obfuscation_via_utf8"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"(WCHAR)0x\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects command line patterns used by BlackByte ransomware in different operations Topic: proc_creation_win_malware_blackbyte_ransomware"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine =~ \" -single \" and InitiatingProcessFolderPath =~ \"C:\\\\Users\\\\Public\\\\\") or (ProcessCommandLine in~ (\"del C:\\\\Windows\\\\System32\\\\Taskmgr.exe\", \";Set-Service -StartupType Disabled $\", \"powershell -command \\\"$x =[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\", \" do start wordpad.exe /p \"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects changes to the registry key \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist\" where the value is set to \"0\" in order to hide user account from being listed on the logon screen.\n Topic: proc_creation_win_registry_special_accounts_hide_user"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\SpecialAccounts\\\\UserList\", \"add\", \"/v\", \"/d 0\")) and InitiatingProcessFolderPath =~ \"\\\\reg.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects an executable initiating a network connection to \"LocaltoNet\" tunneling sub-domains.\nLocaltoNet is a reverse proxy that enables localhost services to be exposed to the Internet.\nAttackers have been seen to use this service for command-and-control activities to bypass MFA and perimeter controls.\n Topic: net_connection_lnx_domain_localtonet_tunnel"}, {"role": "assistant", "content": "DeviceNetworkEvents\n| where InitiatingProcessId =~ \"true\" and (RemoteUrl in~ (\".localto.net\", \".localtonet.com\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potentially suspicious child processes of WinRAR.exe. Topic: proc_creation_win_winrar_susp_child_process"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((FolderPath endswith \"\\\\cmd.exe\" or FolderPath endswith \"\\\\cscript.exe\" or FolderPath endswith \"\\\\mshta.exe\" or FolderPath endswith \"\\\\powershell.exe\" or FolderPath endswith \"\\\\pwsh.exe\" or FolderPath endswith \"\\\\regsvr32.exe\" or FolderPath endswith \"\\\\rundll32.exe\" or FolderPath endswith \"\\\\wscript.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"Cmd.Exe\", \"cscript.exe\", \"mshta.exe\", \"PowerShell.EXE\", \"pwsh.dll\", \"regsvr32.exe\", \"RUNDLL32.EXE\", \"wscript.exe\"))) and InitiatingProcessFileName =~ \"\\\\WinRAR.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the loading of the \"taskschd.dll\" module from a process that located in a potentially suspicious or uncommon directory.\nThe loading of this DLL might indicate that the application have the capability to create a scheduled task via the \"Schedule.Service\" COM object.\nInvestigation of the loading application and its behavior is required to determining if its malicious.\n Topic: image_load_dll_taskschd_by_process_in_potentially_suspicious_location"}, {"role": "assistant", "content": "DeviceImageLoadEvents\n| where (FolderPath endswith \"\\\\taskschd.dll\" or InitiatingProcessVersionInfoOriginalFileName =~ \"taskschd.dll\") and (InitiatingProcessFolderPath contains \":\\\\Temp\\\\\" or InitiatingProcessFolderPath contains \":\\\\Users\\\\Public\\\\\" or InitiatingProcessFolderPath contains \":\\\\Windows\\\\Temp\\\\\" or InitiatingProcessFolderPath contains \"\\\\AppData\\\\Local\\\\Temp\\\\\" or InitiatingProcessFolderPath contains \"\\\\Desktop\\\\\" or InitiatingProcessFolderPath contains \"\\\\Downloads\\\\\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Rule to detect the configuration of Run Once registry key. Configured payload can be run by runonce.exe /AlternateShellStartup Topic: registry_event_runonce_persistence"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (RegistryKey contains \"\\\\Microsoft\\\\Active Setup\\\\Installed Components\" and RegistryKey endswith \"\\\\StubPath\") and (not(((RegistryValueData contains \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\\" and RegistryValueData contains \"\\\\Installer\\\\chrmstp.exe\\\" --configure-user-settings --verbose-logging --system-level\") or ((RegistryValueData contains \"C:\\\\Program Files (x86)\\\\Microsoft\\\\Edge\\\\Application\\\\\" or RegistryValueData contains \"C:\\\\Program Files\\\\Microsoft\\\\Edge\\\\Application\\\\\") and RegistryValueData endswith \"\\\\Installer\\\\setup.exe\\\" --configure-user-settings --verbose-logging --system-level --msedge --channel=stable\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects when a user downloads a file by using CertOC.exe Topic: proc_creation_win_certoc_download"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"-GetCACAPS\", \"http\")) and (FolderPath endswith \"\\\\certoc.exe\" or ProcessVersionInfoOriginalFileName =~ \"CertOC.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of a the file \"execve_hijack\" which is used by the Triple Cross rootkit as a way to elevate privileges Topic: proc_creation_lnx_triple_cross_rootkit_execve_hijack"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"execve_hijack\" and InitiatingProcessFolderPath =~ \"/sudo\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of \"Extexport.exe\".A utility that is part of the Internet Explorer browser and is used to export and import various settings and data, particularly when switching between Internet Explorer and other web browsers like Firefox. It allows users to transfer bookmarks, browsing history, and other preferences from Internet Explorer to Firefox or vice versa.\nIt can be abused as a tool to side load any DLL. If a folder is provided in the command line itll load any DLL with one of the following names \"mozcrt19.dll\", \"mozsqlite3.dll\", or \"sqlite.dll\".\nArbitrary DLLs can also be loaded if a specific number of flags was provided.\n Topic: proc_creation_win_extexport_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where FolderPath endswith \"\\\\Extexport.exe\" or ProcessVersionInfoOriginalFileName =~ \"extexport.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects specific process parameters as used by Mustang Panda droppers Topic: proc_creation_win_apt_mustangpanda"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine contains \"Temp\\\\wtask.exe /create\" or ProcessCommandLine contains \"%windir:~-3,1%%PUBLIC:~-9,1%\" or ProcessCommandLine contains \"/tn \\\"Security Script \" or ProcessCommandLine contains \"%windir:~-1,1%\") or (ProcessCommandLine contains \"/E:vbscript\" and ProcessCommandLine contains \"C:\\\\Users\\\\\" and ProcessCommandLine contains \".txt\" and ProcessCommandLine contains \"/F\")) or InitiatingProcessFolderPath =~ \"Temp\\\\winwsh.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of a renamed \"ftp.exe\" binary based on the PE metadata fields Topic: proc_creation_win_renamed_ftp"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessVersionInfoOriginalFileName =~ \"ftp.exe\" and (not(InitiatingProcessFolderPath =~ \"\\\\ftp.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects executions of scripts located in potentially suspicious locations such as \"/tmp\" via a shell such as \"bash\", \"sh\", etc. Topic: proc_creation_lnx_susp_shell_script_exec_from_susp_location"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \" -c \" and (InitiatingProcessFolderPath in~ (\"/bash\", \"/csh\", \"/dash\", \"/fish\", \"/ksh\", \"/sh\", \"/zsh\")) and ProcessCommandLine =~ \"/tmp/\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of netsh with \"add helper\" flag in order to add a custom helper DLL. This technique can be abused to add a malicious helper DLL that can be used as a persistence proxy that gets called when netsh.exe is executed.\n Topic: proc_creation_win_netsh_helper_dll_persistence"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"add\", \"helper\")) and (ProcessVersionInfoOriginalFileName =~ \"netsh.exe\" or FolderPath endswith \"\\\\netsh.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects process discovery commands. Adversaries may attempt to get information about running processes on a system.\nInformation obtained could be used to gain an understanding of common software/applications running on systems within the network\n Topic: proc_creation_lnx_susp_running_process_discovery"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFolderPath in~ (\"/atop\", \"/htop\", \"/pgrep\", \"/ps\", \"/pstree\", \"/top\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a suspicious execution of a Microsoft HTML Help (HH.exe) Topic: proc_creation_win_hh_susp_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessVersionInfoOriginalFileName =~ \"HH.exe\" or FolderPath endswith \"\\\\hh.exe\") and (ProcessCommandLine in~ (\".application\", \"\\\\AppData\\\\Local\\\\Temp\\\\\", \"\\\\Content.Outlook\\\\\", \"\\\\Downloads\\\\\", \"\\\\Users\\\\Public\\\\\", \"\\\\Windows\\\\Temp\\\\\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n Topic: proc_creation_win_remote_access_tools_ultraviewer"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessVersionInfoProductName =~ \"UltraViewer\" or ProcessVersionInfoCompanyName =~ \"DucFabulous Co,ltd\" or ProcessVersionInfoOriginalFileName =~ \"UltraViewer_Desktop.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the deletion of all backups or system state backups via \"wbadmin.exe\".\nThis technique is used by numerous ransomware families and actors.\nThis may only be successful on server platforms that have Windows Backup enabled.\n Topic: proc_creation_win_wbadmin_delete_all_backups"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"keepVersions:0\" and (FolderPath endswith \"\\\\wbadmin.exe\" or ProcessVersionInfoOriginalFileName =~ \"WBADMIN.EXE\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects usage of command line tools such as \"kill\", \"pkill\" or \"killall\" to terminate or signal a running process. Topic: proc_creation_lnx_susp_process_termination_via_kill"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFolderPath in~ (\"/kill\", \"/killall\", \"/pkill\", \"/xkill\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious child processes of the \"Manage Engine ServiceDesk Plus\" Java web service Topic: proc_creation_win_java_manageengine_susp_child_process"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((InitiatingProcessFileName in~ (\"\\\\ManageEngine\\\\ServiceDesk\\\\\", \"\\\\java.exe\")) and (InitiatingProcessFolderPath in~ (\"\\\\AppVLP.exe\", \"\\\\bash.exe\", \"\\\\bitsadmin.exe\", \"\\\\calc.exe\", \"\\\\certutil.exe\", \"\\\\cscript.exe\", \"\\\\curl.exe\", \"\\\\forfiles.exe\", \"\\\\mftrace.exe\", \"\\\\mshta.exe\", \"\\\\net.exe\", \"\\\\net1.exe\", \"\\\\notepad.exe\", \"\\\\powershell.exe\", \"\\\\pwsh.exe\", \"\\\\query.exe\", \"\\\\reg.exe\", \"\\\\schtasks.exe\", \"\\\\scrcons.exe\", \"\\\\sh.exe\", \"\\\\systeminfo.exe\", \"\\\\whoami.exe\", \"\\\\wmic.exe\", \"\\\\wscript.exe\"))) and (not((ProcessCommandLine =~ \" stop\" and (InitiatingProcessFolderPath in~ (\"\\\\net.exe\", \"\\\\net1.exe\")))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of a new Outlook form which can contain malicious code Topic: file_event_win_office_outlook_newform"}, {"role": "assistant", "content": "DeviceFileEvents\n| where (FileName in~ (\"\\\\AppData\\\\Local\\\\Microsoft\\\\FORMS\\\\IPM\", \"\\\\Local Settings\\\\Application Data\\\\Microsoft\\\\Forms\")) and InitiatingProcessFolderPath =~ \"\\\\outlook.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of Sysinternals ADExplorer with the \"-snapshot\" flag in order to save a local copy of the active directory database. Topic: proc_creation_win_sysinternals_adexplorer_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"snapshot\" and (FolderPath endswith \"\\\\ADExplorer.exe\" or ProcessVersionInfoOriginalFileName =~ \"AdExp\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of the env command to invoke a shell. This may indicate an attempt to bypass restricted environments, escalate privileges, or execute arbitrary commands.\n Topic: proc_creation_lnx_env_shell_invocation"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine endswith \"/bin/bash\" or ProcessCommandLine endswith \"/bin/dash\" or ProcessCommandLine endswith \"/bin/fish\" or ProcessCommandLine endswith \"/bin/sh\" or ProcessCommandLine endswith \"/bin/zsh\") and InitiatingProcessFolderPath =~ \"/env\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of a file with the \".pdf\" extension by the \"RegEdit.exe\" process.\nThis indicates that a user is trying to print/save a registry key as a PDF in order to potentially extract sensitive information and bypass defenses.\n Topic: file_event_win_regedit_print_as_pdf"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \".pdf\" and InitiatingProcessFolderPath =~ \"\\\\regedit.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum Topic: file_event_win_cve_2021_31979_cve_2021_33771_exploits"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName in~ (\"C:\\\\Windows\\\\system32\\\\physmem.sys\", \"C:\\\\Windows\\\\System32\\\\IME\\\\IMEJP\\\\imjpueact.dll\", \"C:\\\\Windows\\\\system32\\\\ime\\\\IMETC\\\\IMTCPROT.DLL\", \"C:\\\\Windows\\\\system32\\\\ime\\\\SHARED\\\\imecpmeid.dll\", \"C:\\\\Windows\\\\system32\\\\config\\\\spp\\\\ServiceState\\\\Recovery\\\\pac.dat\", \"C:\\\\Windows\\\\system32\\\\config\\\\cy-GB\\\\Setup\\\\SKB\\\\InputMethod\\\\TupTask.dat\", \"C:\\\\Windows\\\\system32\\\\config\\\\config\\\\startwus.dat\", \"C:\\\\Windows\\\\system32\\\\ime\\\\SHARED\\\\WimBootConfigurations.ini\", \"C:\\\\Windows\\\\system32\\\\ime\\\\IMEJP\\\\WimBootConfigurations.ini\", \"C:\\\\Windows\\\\system32\\\\ime\\\\IMETC\\\\WimBootConfigurations.ini\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "setupapi.dll library provide InstallHinfSection function for processing INF files. INF file may contain instructions allowing to create values in the registry, modify files and install drivers. This technique could be used to obtain persistence via modifying one of Run or RunOnce registry keys, run process or use other DLLs chain calls (see references) InstallHinfSection function in setupapi.dll calls runonce.exe executable regardless of actual content of INF file. Topic: proc_creation_win_rundll32_setupapi_installhinfsection"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (InitiatingProcessCommandLine in~ (\"setupapi.dll\", \"InstallHinfSection\")) and InitiatingProcessFileName =~ \"\\\\rundll32.exe\" and InitiatingProcessFolderPath =~ \"\\\\runonce.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects disabling of Time Machine (Apples automated backup utility software) via the native macOS backup utility \"tmutil\".\nAn attacker can use this to prevent backups from occurring.\n Topic: proc_creation_macos_tmutil_disable_backup"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"disable\" and (FolderPath endswith \"/tmutil\" or ProcessCommandLine contains \"tmutil\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a suspicious copy operation that tries to copy a program from system (System32, SysWOW64, WinSxS) directories to another on disk.\nOften used to move LOLBINs such as certutil or desktopimgdownldr to a different location with a different name in order to bypass detections based on locations.\n Topic: proc_creation_win_susp_copy_system_dir"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine =~ \"copy \" and InitiatingProcessFolderPath =~ \"\\\\cmd.exe\") or ((FolderPath endswith \"\\\\robocopy.exe\" or FolderPath endswith \"\\\\xcopy.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"robocopy.exe\", \"XCOPY.EXE\"))) or ((ProcessCommandLine in~ (\"copy-item\", \" copy \", \"cpi \", \" cp \")) and (InitiatingProcessFolderPath in~ (\"\\\\powershell.exe\", \"\\\\pwsh.exe\")))) and (ProcessCommandLine in~ (\"\\\\System32\", \"\\\\SysWOW64\", \"\\\\WinSxS\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the addition of a SSP to the registry. Upon a reboot or API call, SSP DLLs gain access to encrypted and plaintext passwords stored in Windows.\n Topic: registry_event_ssp_added_lsa_config"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (RegistryKey endswith \"\\\\Control\\\\Lsa\\\\Security Packages\" or RegistryKey endswith \"\\\\Control\\\\Lsa\\\\OSConfig\\\\Security Packages\") and (not((InitiatingProcessFolderPath in~ (\"C:\\\\Windows\\\\system32\\\\msiexec.exe\", \"C:\\\\Windows\\\\syswow64\\\\MsiExec.exe\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects creation of files which are the results of executing the built-in reconnaissance script \"C:\\Windows\\System32\\gatherNetworkInfo.vbs\". Topic: file_event_win_lolbin_gather_network_info_script_output"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName in~ (\"\\\\Hotfixinfo.txt\", \"\\\\netiostate.txt\", \"\\\\sysportslog.txt\", \"\\\\VmSwitchLog.evtx\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects wscript/cscript executions of scripts located in user directories Topic: proc_creation_win_wscript_cscript_dropper"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (InitiatingProcessFolderPath in~ (\"\\\\wscript.exe\", \"\\\\cscript.exe\")) and (ProcessCommandLine in~ (\".js\", \".jse\", \".vba\", \".vbe\", \".vbs\", \".wsf\")) and (ProcessCommandLine in~ (\":\\\\Temp\\\\\", \":\\\\Tmp\\\\\", \":\\\\Users\\\\Public\\\\\", \":\\\\Windows\\\\Temp\\\\\", \"\\\\AppData\\\\Local\\\\Temp\\\\\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "A General detection for sdclt spawning new processes. This could be an indicator of sdclt being used for bypass UAC techniques. Topic: proc_creation_win_sdclt_child_process"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"\\\\sdclt.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Adversaries can interact with the DACLs using built-in Windows commands takeown which can grant adversaries higher permissions on specific files and folders Topic: proc_creation_win_takeown_recursive_own"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"/f \", \"/r\")) and InitiatingProcessFolderPath =~ \"\\\\takeown.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious ways to run Invoke-Execution using IEX alias Topic: proc_creation_win_powershell_iex_patterns"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (((ProcessCommandLine in~ (\" | iex;\", \" | iex \", \" | iex}\", \" | IEX ;\", \" | IEX -Error\", \" | IEX (new\", \");IEX \")) and (InitiatingProcessFolderPath in~ (\"\\\\powershell.exe\", \"\\\\pwsh.exe\"))) and (ProcessCommandLine in~ (\"::FromBase64String\", \".GetString([System.Convert]::\"))) or (ProcessCommandLine in~ (\")|iex;$\", \");iex($\", \");iex $\", \" | IEX | \", \" | iex\\\\\\\"\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of System Informer, a task manager tool to view and manipulate processes, kernel options and other low level operations Topic: proc_creation_win_pua_system_informer"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where FolderPath endswith \"\\\\SystemInformer.exe\" or ProcessVersionInfoOriginalFileName =~ \"SystemInformer.exe\" or ProcessVersionInfoFileDescription =~ \"System Informer\" or ProcessVersionInfoProductName =~ \"System Informer\" or (MD5 startswith \"19426363A37C03C3ED6FEDF57B6696EC\" or SHA1 startswith \"8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC\" or SHA256 startswith \"8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Ransomware create txt file in the user Desktop Topic: file_event_win_susp_desktop_txt"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \".txt\" and InitiatingProcessFolderPath =~ \"\\\\cmd.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects process creation activity indicators related to Diamond Sleet APT Topic: proc_creation_win_apt_diamond_sleet_indicators"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \" uTYNkfKxHiZrx3KJ\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects Commandlet names from well-known PowerShell exploitation frameworks Topic: proc_creation_win_powershell_malicious_cmdlets"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"Add-Exfiltration\", \"Add-Persistence\", \"Add-RegBackdoor\", \"Add-RemoteRegBackdoor\", \"Add-ScrnSaveBackdoor\", \"Check-VM\", \"ConvertTo-Rc4ByteStream\", \"Decrypt-Hash\", \"Disable-ADIDNSNode\", \"Disable-MachineAccount\", \"Do-Exfiltration\", \"Enable-ADIDNSNode\", \"Enable-MachineAccount\", \"Enabled-DuplicateToken\", \"Exploit-Jboss\", \"Export-ADR\", \"Export-ADRCSV\", \"Export-ADRExcel\", \"Export-ADRHTML\", \"Export-ADRJSON\", \"Export-ADRXML\", \"Find-Fruit\", \"Find-GPOLocation\", \"Find-TrustedDocuments\", \"Get-ADIDNS\", \"Get-ApplicationHost\", \"Get-ChromeDump\", \"Get-ClipboardContents\", \"Get-FoxDump\", \"Get-GPPPassword\", \"Get-IndexedItem\", \"Get-KerberosAESKey\", \"Get-Keystrokes\", \"Get-LSASecret\", \"Get-MachineAccountAttribute\", \"Get-MachineAccountCreator\", \"Get-PassHashes\", \"Get-RegAlwaysInstallElevated\", \"Get-RegAutoLogon\", \"Get-RemoteBootKey\", \"Get-RemoteCachedCredential\", \"Get-RemoteLocalAccountHash\", \"Get-RemoteLSAKey\", \"Get-RemoteMachineAccountHash\", \"Get-RemoteNLKMKey\", \"Get-RickAstley\", \"Get-Screenshot\", \"Get-SecurityPackages\", \"Get-ServiceFilePermission\", \"Get-ServicePermission\", \"Get-ServiceUnquoted\", \"Get-SiteListPassword\", \"Get-System\", \"Get-TimedScreenshot\", \"Get-UnattendedInstallFile\", \"Get-Unconstrained\", \"Get-USBKeystrokes\", \"Get-VaultCredential\", \"Get-VulnAutoRun\", \"Get-VulnSchTask\", \"Grant-ADIDNSPermission\", \"Gupt-Backdoor\", \"HTTP-Login\", \"Install-ServiceBinary\", \"Install-SSP\", \"Invoke-ACLScanner\", \"Invoke-ADRecon\", \"Invoke-ADSBackdoor\", \"Invoke-AgentSmith\", \"Invoke-AllChecks\", \"Invoke-ARPScan\", \"Invoke-AzureHound\", \"Invoke-BackdoorLNK\", \"Invoke-BadPotato\", \"Invoke-BetterSafetyKatz\", \"Invoke-BypassUAC\", \"Invoke-Carbuncle\", \"Invoke-Certify\", \"Invoke-ConPtyShell\", \"Invoke-CredentialInjection\", \"Invoke-DAFT\", \"Invoke-DCSync\", \"Invoke-DinvokeKatz\", \"Invoke-DllInjection\", \"Invoke-DNSUpdate\", \"Invoke-DomainPasswordSpray\", \"Invoke-DowngradeAccount\", \"Invoke-EgressCheck\", \"Invoke-Eyewitness\", \"Invoke-FakeLogonScreen\", \"Invoke-Farmer\", \"Invoke-Get-RBCD-Threaded\", \"Invoke-Gopher\", \"Invoke-Grouper\", \"Invoke-HandleKatz\", \"Invoke-ImpersonatedProcess\", \"Invoke-ImpersonateSystem\", \"Invoke-InteractiveSystemPowerShell\", \"Invoke-Internalmonologue\", \"Invoke-Inveigh\", \"Invoke-InveighRelay\", \"Invoke-KrbRelay\", \"Invoke-LdapSignCheck\", \"Invoke-Lockless\", \"Invoke-MalSCCM\", \"Invoke-Mimikatz\", \"Invoke-Mimikittenz\", \"Invoke-MITM6\", \"Invoke-NanoDump\", \"Invoke-NetRipper\", \"Invoke-Nightmare\", \"Invoke-NinjaCopy\", \"Invoke-OfficeScrape\", \"Invoke-OxidResolver\", \"Invoke-P0wnedshell\", \"Invoke-Paranoia\", \"Invoke-PortScan\", \"Invoke-PoshRatHttp\", \"Invoke-PostExfil\", \"Invoke-PowerDump\", \"Invoke-PowerShellTCP\", \"Invoke-PowerShellWMI\", \"Invoke-PPLDump\", \"Invoke-PsExec\", \"Invoke-PSInject\", \"Invoke-PsUaCme\", \"Invoke-ReflectivePEInjection\", \"Invoke-ReverseDNSLookup\", \"Invoke-Rubeus\", \"Invoke-RunAs\", \"Invoke-SafetyKatz\", \"Invoke-SauronEye\", \"Invoke-SCShell\", \"Invoke-Seatbelt\", \"Invoke-ServiceAbuse\", \"Invoke-ShadowSpray\", \"Invoke-Sharp\", \"Invoke-Shellcode\", \"Invoke-SMBScanner\", \"Invoke-Snaffler\", \"Invoke-Spoolsample\", \"Invoke-SpraySinglePassword\", \"Invoke-SSHCommand\", \"Invoke-StandIn\", \"Invoke-StickyNotesExtract\", \"Invoke-SystemCommand\", \"Invoke-Tasksbackdoor\", \"Invoke-Tater\", \"Invoke-Thunderfox\", \"Invoke-ThunderStruck\", \"Invoke-TokenManipulation\", \"Invoke-Tokenvator\", \"Invoke-TotalExec\", \"Invoke-UrbanBishop\", \"Invoke-UserHunter\", \"Invoke-VoiceTroll\", \"Invoke-Whisker\", \"Invoke-WinEnum\", \"Invoke-winPEAS\", \"Invoke-WireTap\", \"Invoke-WmiCommand\", \"Invoke-WMIExec\", \"Invoke-WScriptBypassUAC\", \"Invoke-Zerologon\", \"MailRaider\", \"New-ADIDNSNode\", \"New-DNSRecordArray\", \"New-HoneyHash\", \"New-InMemoryModule\", \"New-MachineAccount\", \"New-SOASerialNumberArray\", \"Out-Minidump\", \"Port-Scan\", \"PowerBreach\", \"powercat \", \"PowerUp\", \"PowerView\", \"Remove-ADIDNSNode\", \"Remove-MachineAccount\", \"Remove-Update\", \"Rename-ADIDNSNode\", \"Revoke-ADIDNSPermission\", \"Set-ADIDNSNode\", \"Set-MacAttribute\", \"Set-MachineAccountAttribute\", \"Set-Wallpaper\", \"Show-TargetScreen\", \"Start-CaptureServer\", \"Start-Dnscat2\", \"Start-WebcamRecorder\", \"VolumeShadowCopyTools\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects attackers using tooling with bad opsec defaults.\nE.g. spawning a sacrificial process to inject a capability into the process without taking into account how the process is normally run.\nOne trivial example of this is using rundll32.exe without arguments as a sacrificial process (default in CS, now highlighted by c2lint), running WerFault without arguments (Kraken - credit am0nsec), and other examples.\n Topic: proc_creation_win_susp_bad_opsec_sacrificial_processes"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine endswith \"regasm.exe\" and InitiatingProcessFolderPath =~ \"\\\\regasm.exe\") or (ProcessCommandLine endswith \"regsvcs.exe\" and InitiatingProcessFolderPath =~ \"\\\\regsvcs.exe\") or (ProcessCommandLine endswith \"regsvr32.exe\" and InitiatingProcessFolderPath =~ \"\\\\regsvr32.exe\") or (ProcessCommandLine endswith \"rundll32.exe\" and InitiatingProcessFolderPath =~ \"\\\\rundll32.exe\") or (ProcessCommandLine endswith \"WerFault.exe\" and InitiatingProcessFolderPath =~ \"\\\\WerFault.exe\")) and (not(((ProcessCommandLine endswith \"rundll32.exe\" and InitiatingProcessCommandLine =~ \"--uninstall \" and InitiatingProcessFileName =~ \"\\\\Installer\\\\setup.exe\" and InitiatingProcessFolderPath =~ \"\\\\rundll32.exe\") or (ProcessCommandLine endswith \"rundll32.exe\" and InitiatingProcessFileName =~ \"\\\\AppData\\\\Local\\\\Microsoft\\\\EdgeUpdate\\\\Install\\\\{\" and InitiatingProcessFolderPath =~ \"\\\\rundll32.exe\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects msdt.exe creating files in suspicious directories which could be a sign of exploitation of either Follina or Dogwalk vulnerabilities Topic: file_event_win_msdt_susp_directories"}, {"role": "assistant", "content": "DeviceFileEvents\n| where (FileName in~ (\"\\\\Desktop\\\\\", \"\\\\Start Menu\\\\Programs\\\\Startup\\\\\", \"C:\\\\PerfLogs\\\\\", \"C:\\\\ProgramData\\\\\", \"C:\\\\Users\\\\Public\\\\\")) and InitiatingProcessFolderPath =~ \"\\\\msdt.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects requests to exclude files, folders or processes from Antivirus scanning using PowerShell cmdlets Topic: proc_creation_win_powershell_defender_exclusion"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"Add-MpPreference \", \"Set-MpPreference \")) and (ProcessCommandLine in~ (\" -ExclusionPath \", \" -ExclusionExtension \", \" -ExclusionProcess \", \" -ExclusionIpAddress \"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of EDRSilencer, a tool that leverages Windows Filtering Platform (WFP) to block Endpoint Detection and Response (EDR) agents from reporting security events to the server based on PE metadata information.\n Topic: proc_creation_win_hktl_edrsilencer"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where FolderPath endswith \"\\\\EDRSilencer.exe\" or ProcessVersionInfoOriginalFileName =~ \"EDRSilencer.exe\" or ProcessVersionInfoFileDescription contains \"EDRSilencer\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of a renamed Microsoft Teams binary. Topic: proc_creation_win_renamed_msteams"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessVersionInfoOriginalFileName in~ (\"msteams.exe\", \"teams.exe\")) and (not((InitiatingProcessFolderPath in~ (\"\\\\msteams.exe\", \"\\\\teams.exe\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects an a non-browser process interacting with the Telegram API which could indicate use of a covert C2 Topic: net_connection_win_domain_telegram_api_non_browser_access"}, {"role": "assistant", "content": "DeviceNetworkEvents\n| where RemoteUrl =~ \"api.telegram.org\" and (not((InitiatingProcessFolderPath =~ \"\\\\brave.exe\" or (InitiatingProcessFolderPath in~ (\"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\", \"C:\\\\Program Files (x86)\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\")) or (InitiatingProcessFolderPath startswith \"C:\\\\Program Files (x86)\\\\Microsoft\\\\EdgeWebView\\\\Application\\\\\" or InitiatingProcessFolderPath endswith \"\\\\WindowsApps\\\\MicrosoftEdge.exe\" or (InitiatingProcessFolderPath in~ (\"C:\\\\Program Files (x86)\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe\", \"C:\\\\Program Files\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe\"))) or (InitiatingProcessFolderPath in~ (\"C:\\\\Program Files (x86)\\\\Microsoft\\\\EdgeCore\\\\\", \"C:\\\\Program Files\\\\Microsoft\\\\EdgeCore\\\\\")) or (InitiatingProcessFolderPath in~ (\"C:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe\", \"C:\\\\Program Files (x86)\\\\Mozilla Firefox\\\\firefox.exe\")) or (InitiatingProcessFolderPath in~ (\"C:\\\\Program Files (x86)\\\\Internet Explorer\\\\iexplore.exe\", \"C:\\\\Program Files\\\\Internet Explorer\\\\iexplore.exe\")) or InitiatingProcessFolderPath =~ \"\\\\maxthon.exe\" or InitiatingProcessFolderPath =~ \"\\\\opera.exe\" or InitiatingProcessFolderPath =~ \"\\\\safari.exe\" or InitiatingProcessFolderPath =~ \"\\\\seamonkey.exe\" or InitiatingProcessFolderPath =~ \"\\\\vivaldi.exe\" or InitiatingProcessFolderPath =~ \"\\\\whale.exe\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects modification of autostart extensibility point (ASEP) in registry. Topic: registry_set_asep_reg_keys_modification_common"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (RegistryKey contains \"\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows CE Services\\\\AutoStart\" or RegistryKey contains \"\\\\Software\\\\Wow6432Node\\\\Microsoft\\\\Command Processor\\\\Autorun\" or RegistryKey contains \"\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Active Setup\\\\Installed Components\" or RegistryKey contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows CE Services\\\\AutoStartOnDisconnect\" or RegistryKey contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows CE Services\\\\AutoStartOnConnect\" or RegistryKey contains \"\\\\SYSTEM\\\\Setup\\\\CmdLine\" or RegistryKey contains \"\\\\Software\\\\Microsoft\\\\Ctf\\\\LangBarAddin\" or RegistryKey contains \"\\\\Software\\\\Microsoft\\\\Command Processor\\\\Autorun\" or RegistryKey contains \"\\\\SOFTWARE\\\\Microsoft\\\\Active Setup\\\\Installed Components\" or RegistryKey contains \"\\\\SOFTWARE\\\\Classes\\\\Protocols\\\\Handler\" or RegistryKey contains \"\\\\SOFTWARE\\\\Classes\\\\Protocols\\\\Filter\" or RegistryKey contains \"\\\\SOFTWARE\\\\Classes\\\\Htmlfile\\\\Shell\\\\Open\\\\Command\\\\(Default)\" or RegistryKey contains \"\\\\Environment\\\\UserInitMprLogonScript\" or RegistryKey contains \"\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\Control Panel\\\\Desktop\\\\Scrnsave.exe\" or RegistryKey contains \"\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\UrlSearchHooks\" or RegistryKey contains \"\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Desktop\\\\Components\" or RegistryKey contains \"\\\\Software\\\\Classes\\\\Clsid\\\\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\\\\Inprocserver32\" or RegistryKey contains \"\\\\Control Panel\\\\Desktop\\\\Scrnsave.exe\") and (not((RegistryKey contains \"\\\\Software\\\\Microsoft\\\\Active Setup\\\\Installed Components\\\\{89820200-ECBD-11cf-8B85-00AA005B4383}\" or RegistryKey contains \"\\\\SOFTWARE\\\\Microsoft\\\\Active Setup\\\\Installed Components\\\\{8A69D345-D564-463c-AFF1-A69D9E530F96}\" or RegistryKey contains \"\\\\SOFTWARE\\\\Microsoft\\\\Active Setup\\\\Installed Components\\\\{9459C573-B17A-45AE-9F64-1857B5D58CEE}\" or RegistryValueData =~ \"(Empty)\" or (InitiatingProcessFolderPath in~ (\"C:\\\\Windows\\\\System32\\\\poqexec.exe\", \"C:\\\\Program Files (x86)\\\\Microsoft Office\\\\root\\\\integration\\\\integrator.exe\")) or ((RegistryKey endswith \"\\\\Office\\\\ClickToRun\\\\REGISTRY\\\\MACHINE\\\\Software\\\\Classes\\\\PROTOCOLS\\\\Handler*\" or RegistryKey endswith \"\\\\ClickToRunStore\\\\HKMU\\\\SOFTWARE\\\\Classes\\\\PROTOCOLS\\\\Handler*\") or (RegistryValueData in~ (\"{314111c7-a502-11d2-bbca-00c04f8ec294}\", \"{3459B272-CC19-4448-86C9-DDC3B4B2FAD3}\", \"{42089D2D-912D-4018-9087-2B87803E93FB}\", \"{5504BE45-A83B-4808-900A-3A5C36E7F77A}\", \"{807583E5-5146-11D5-A672-00B0D022E945}\"))) or InitiatingProcessFolderPath =~ \"\\\\OfficeClickToRun.exe\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of commands that leverage the \"mshtml.dll\" RunHTMLApplication export to run arbitrary code via different protocol handlers (vbscript, javascript, file, http...)\n Topic: proc_creation_win_rundll32_mshtml_runhtmlapplication"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"#135\", \"RunHTMLApplication\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of AdvancedRun utility Topic: proc_creation_win_pua_advancedrun"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessVersionInfoOriginalFileName =~ \"AdvancedRun.exe\" or (ProcessCommandLine contains \" /EXEFilename \" and ProcessCommandLine contains \" /Run\") or (ProcessCommandLine contains \" /WindowState 0\" and ProcessCommandLine contains \" /RunAs \" and ProcessCommandLine contains \" /CommandLine \")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage Topic: registry_set_disable_defender_firewall"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey endswith \"\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy*\" and RegistryKey endswith \"\\\\EnableFirewall\" and RegistryValueData =~ \"DWORD (0x00000000)\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a Windows command line executable started from MMC Topic: proc_creation_win_mmc_susp_child_process"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"\\\\mmc.exe\" and ((FolderPath endswith \"\\\\cmd.exe\" or FolderPath endswith \"\\\\powershell.exe\" or FolderPath endswith \"\\\\pwsh.exe\" or FolderPath endswith \"\\\\wscript.exe\" or FolderPath endswith \"\\\\cscript.exe\" or FolderPath endswith \"\\\\sh.exe\" or FolderPath endswith \"\\\\bash.exe\" or FolderPath endswith \"\\\\reg.exe\" or FolderPath endswith \"\\\\regsvr32.exe\") or FolderPath contains \"\\\\BITSADMIN\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of DefenderCheck, a tool to evaluate the signatures used in Microsoft Defender. It can be used to figure out the strings / byte chains used in Microsoft Defender to detect a tool and thus used for AV evasion. Topic: proc_creation_win_pua_defendercheck"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where FolderPath endswith \"\\\\DefenderCheck.exe\" or ProcessVersionInfoFileDescription =~ \"DefenderCheck\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This rule detect using dd and truncate to add a junk data to file. Topic: proc_creation_macos_binary_padding"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine in~ (\"if=/dev/zero\", \"if=/dev/random\", \"if=/dev/urandom\")) and InitiatingProcessFolderPath =~ \"/dd\") or (ProcessCommandLine =~ \"-s +\" and InitiatingProcessFolderPath =~ \"/truncate\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects modification of autostart extensibility point (ASEP) in registry. Topic: registry_set_asep_reg_keys_modification_winsock2"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey contains \"\\\\System\\\\CurrentControlSet\\\\Services\\\\WinSock2\\\\Parameters\" and (RegistryKey contains \"\\\\Protocol_Catalog9\\\\Catalog_Entries\" or RegistryKey contains \"\\\\NameSpace_Catalog5\\\\Catalog_Entries\") and (not((RegistryValueData =~ \"(Empty)\" or InitiatingProcessFolderPath =~ \"C:\\\\Windows\\\\System32\\\\MsiExec.exe\" or InitiatingProcessFolderPath =~ \"C:\\\\Windows\\\\syswow64\\\\MsiExec.exe\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects successful logon attempts performed with WMI Topic: win_security_susp_wmi_login"}, {"role": "assistant", "content": "DeviceLogonEvents\n| where InitiatingProcessFolderPath endswith \"\\\\WmiPrvSE.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects enabling TurnOffCheck which can be used to bypass defense of MSDT Follina vulnerability Topic: registry_set_enabling_turnoffcheck"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey endswith \"\\\\Policies\\\\Microsoft\\\\Windows\\\\ScriptedDiagnostics\\\\TurnOffCheck\" and RegistryValueData =~ \"DWORD (0x00000001)\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a suspicious child process spawning from Outlook where the image is located in a remote location (SMB/WebDav shares). Topic: proc_creation_win_office_outlook_susp_child_processes_remote"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"\\\\outlook.exe\" and InitiatingProcessFolderPath =~ \"\\\\\\\\\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects RunDLL32.exe spawning explorer.exe as child, which is very uncommon, often observes Gamarue spawning the explorer.exe process in an unusual way Topic: proc_creation_win_rundll32_spawn_explorer"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (InitiatingProcessFileName =~ \"\\\\rundll32.exe\" and InitiatingProcessFolderPath =~ \"\\\\explorer.exe\") and (not(InitiatingProcessCommandLine =~ \"\\\\shell32.dll,Control_RunDLL\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of grep to discover specific files created by the GobRAT malware Topic: proc_creation_lnx_malware_gobrat_grep_payload_discovery"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"apached\", \"frpc\", \"sshd.sh\", \"zone.arm\")) and InitiatingProcessFolderPath =~ \"/grep\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects attempts to enable the root account via \"dsenableroot\" Topic: proc_creation_macos_dsenableroot_enable_root_account"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFolderPath =~ \"/dsenableroot\" and (not(ProcessCommandLine =~ \" -d \"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects file creation patterns noticeable during the exploitation of CVE-2021-40444 Topic: file_event_win_exploit_cve_2021_40444"}, {"role": "assistant", "content": "DeviceFileEvents\n| where ((FileName =~ \".cab\" and InitiatingProcessFolderPath =~ \"\\\\winword.exe\") or ((FileName in~ (\"\\\\AppData\\\\Local\\\\Temp\\\\\", \".inf\")) and InitiatingProcessFolderPath =~ \"\\\\winword.exe\")) and (not(FileName =~ \"C:\\\\Users\\\\\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of Remote Utilities RAT (RURAT) from an unusual location (outside of C:\\Program Files) Topic: proc_creation_win_remote_access_tools_rurat_non_default_location"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((FolderPath endswith \"\\\\rutserv.exe\" or FolderPath endswith \"\\\\rfusclient.exe\") or ProcessVersionInfoProductName =~ \"Remote Utilities\") and (not((InitiatingProcessFolderPath in~ (\"C:\\\\Program Files\\\\Remote Utilities\", \"C:\\\\Program Files (x86)\\\\Remote Utilities\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects an unexpected process spawning from dns.exe which may indicate activity related to remote code execution or other forms of exploitation as seen in CVE-2020-1350 (SigRed) Topic: proc_creation_win_dns_susp_child_process"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"\\\\dns.exe\" and (not(InitiatingProcessFolderPath =~ \"\\\\conhost.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects java process spawning suspicious children Topic: proc_creation_lnx_susp_java_children"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"/java\" and (ProcessCommandLine in~ (\"/bin/sh\", \"bash\", \"dash\", \"ksh\", \"zsh\", \"csh\", \"fish\", \"curl\", \"wget\", \"python\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious process run from unusual locations Topic: proc_creation_win_rundll32_run_locations"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (FolderPath contains \":\\\\RECYCLER\\\\\" or FolderPath contains \":\\\\SystemVolumeInformation\\\\\") or (FolderPath startswith \"C:\\\\Windows\\\\Tasks\\\\\" or FolderPath startswith \"C:\\\\Windows\\\\debug\\\\\" or FolderPath startswith \"C:\\\\Windows\\\\fonts\\\\\" or FolderPath startswith \"C:\\\\Windows\\\\help\\\\\" or FolderPath startswith \"C:\\\\Windows\\\\drivers\\\\\" or FolderPath startswith \"C:\\\\Windows\\\\addins\\\\\" or FolderPath startswith \"C:\\\\Windows\\\\cursors\\\\\" or FolderPath startswith \"C:\\\\Windows\\\\system32\\\\tasks\\\\\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects shell spawned from Java host process, which could be a sign of exploitation (e.g. log4j exploitation) Topic: proc_creation_win_java_susp_child_process_2"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (InitiatingProcessFileName =~ \"\\\\java.exe\" and (InitiatingProcessFolderPath in~ (\"\\\\bash.exe\", \"\\\\cmd.exe\", \"\\\\powershell.exe\", \"\\\\pwsh.exe\"))) and (not((InitiatingProcessFileName =~ \"build\" and ProcessCommandLine =~ \"build\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a set of suspicious network related commands often used in recon stages Topic: proc_creation_win_nslookup_domain_discovery"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"nslookup\", \"_ldap._tcp.dc._msdcs.\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the deletion of AMSI provider registry key entries in HKLM\\Software\\Microsoft\\AMSI. This technique could be used by an attacker in order to disable AMSI inspection. Topic: registry_delete_removal_amsi_registry_key"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (ActionType in~ (\"RegistryKeyDeleted\", \"RegistryValueDeleted\")) and (RegistryKey endswith \"{2781761E-28E0-4109-99FE-B9D127C57AFE}\" or RegistryKey endswith \"{A7C452EF-8E9F-42EB-9F2B-245613CA0DC9}\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a dump file written by QuarksPwDump password dumper Topic: file_event_win_hktl_quarkspw_filedump"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName in~ (\"\\\\AppData\\\\Local\\\\Temp\\\\SAM-\", \".dmp\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects process creation activity related to Peach Sandstorm APT Topic: proc_creation_win_apt_peach_sandstorm_indicators"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"QP's*(58vaP!tF4\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the usage of attrib with the \"+s\" option to set scripts or executables located in suspicious locations as system files to hide them from users and make them unable to be deleted with simple rights. The rule limits the search to specific extensions and directories to avoid FPs\n Topic: proc_creation_win_attrib_system_susp_paths"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine =~ \" +s\" and (ProcessCommandLine in~ (\".bat\", \".dll\", \".exe\", \".hta\", \".ps1\", \".vbe\", \".vbs\")) and (FolderPath endswith \"\\\\attrib.exe\" or ProcessVersionInfoOriginalFileName =~ \"ATTRIB.EXE\") and (ProcessCommandLine in~ (\" %\", \"\\\\Users\\\\Public\\\\\", \"\\\\AppData\\\\Local\\\\\", \"\\\\ProgramData\\\\\", \"\\\\Downloads\\\\\", \"\\\\Windows\\\\Temp\\\\\"))) and (not((ProcessCommandLine in~ (\"\\\\Windows\\\\TEMP\\\\\", \".exe\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential malicious and unauthorized usage of bcdedit.exe Topic: proc_creation_win_bcdedit_susp_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"delete\", \"deletevalue\", \"import\", \"safeboot\", \"network\")) and (FolderPath endswith \"\\\\bcdedit.exe\" or ProcessVersionInfoOriginalFileName =~ \"bcdedit.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of a shell (powershell, bash, wsl...) via Visual Studio Code tunnel. Attackers can abuse this functionality to establish a C2 channel and execute arbitrary commands on the system. Topic: proc_creation_win_vscode_tunnel_remote_shell_"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (InitiatingProcessCommandLine =~ \".vscode-server\" and InitiatingProcessFileName =~ \"\\\\server\\\\node.exe\") and ((ProcessCommandLine =~ \"\\\\terminal\\\\browser\\\\media\\\\shellIntegration.ps1\" and (InitiatingProcessFolderPath in~ (\"\\\\powershell.exe\", \"\\\\pwsh.exe\"))) or (InitiatingProcessFolderPath in~ (\"\\\\wsl.exe\", \"\\\\bash.exe\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of the \"accepteula\" key related to the Sysinternals tools being created from executables with the wrong name (e.g. a renamed Sysinternals tool) Topic: registry_add_pua_sysinternals_renamed_execution_via_eula"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (ActionType =~ \"RegistryKeyCreated\" and (RegistryKey contains \"\\\\Active Directory Explorer\" or RegistryKey contains \"\\\\Handle\" or RegistryKey contains \"\\\\LiveKd\" or RegistryKey contains \"\\\\ProcDump\" or RegistryKey contains \"\\\\Process Explorer\" or RegistryKey contains \"\\\\PsExec\" or RegistryKey contains \"\\\\PsLoggedon\" or RegistryKey contains \"\\\\PsLoglist\" or RegistryKey contains \"\\\\PsPasswd\" or RegistryKey contains \"\\\\PsPing\" or RegistryKey contains \"\\\\PsService\" or RegistryKey contains \"\\\\SDelete\") and RegistryKey endswith \"\\\\EulaAccepted\") and (not((InitiatingProcessFolderPath in~ (\"\\\\ADExplorer.exe\", \"\\\\ADExplorer64.exe\", \"\\\\handle.exe\", \"\\\\handle64.exe\", \"\\\\livekd.exe\", \"\\\\livekd64.exe\", \"\\\\procdump.exe\", \"\\\\procdump64.exe\", \"\\\\procexp.exe\", \"\\\\procexp64.exe\", \"\\\\PsExec.exe\", \"\\\\PsExec64.exe\", \"\\\\PsLoggedon.exe\", \"\\\\PsLoggedon64.exe\", \"\\\\psloglist.exe\", \"\\\\psloglist64.exe\", \"\\\\pspasswd.exe\", \"\\\\pspasswd64.exe\", \"\\\\PsPing.exe\", \"\\\\PsPing64.exe\", \"\\\\PsService.exe\", \"\\\\PsService64.exe\", \"\\\\sdelete.exe\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of Advanced Port Scanner. Topic: proc_creation_win_pua_advanced_port_scanner"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"/portable\", \"/lng\")) or (FolderPath contains \"\\\\advanced_port_scanner\" or ProcessVersionInfoOriginalFileName contains \"advanced_port_scanner\" or ProcessVersionInfoFileDescription contains \"Advanced Port Scanner\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of a scheduled task via Registry keys. Topic: registry_event_scheduled_task_creation"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey endswith \"\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Schedule\\\\TaskCache\\\\Tasks*\" or RegistryKey endswith \"\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Schedule\\\\TaskCache\\\\Tree*\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the import of the specified file to the registry with regedit.exe. Topic: proc_creation_win_regedit_import_keys"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine in~ (\" /i \", \" /s \", \".reg\")) and (FolderPath endswith \"\\\\regedit.exe\" or ProcessVersionInfoOriginalFileName =~ \"REGEDIT.EXE\")) and (not(((ProcessCommandLine contains \" -e \" or ProcessCommandLine contains \" /e \" or ProcessCommandLine contains \" \u2013e \" or ProcessCommandLine contains \" \u2014e \" or ProcessCommandLine contains \" \u2015e \" or ProcessCommandLine contains \" -a \" or ProcessCommandLine contains \" /a \" or ProcessCommandLine contains \" \u2013a \" or ProcessCommandLine contains \" \u2014a \" or ProcessCommandLine contains \" \u2015a \" or ProcessCommandLine contains \" -c \" or ProcessCommandLine contains \" /c \" or ProcessCommandLine contains \" \u2013c \" or ProcessCommandLine contains \" \u2014c \" or ProcessCommandLine contains \" \u2015c \") and ProcessCommandLine matches regex \":[^ \\\\\\\\]\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects events in which someone prints the contents of history files to the commandline or redirects it to a file for reconnaissance Topic: proc_creation_lnx_susp_history_recon"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (InitiatingProcessFolderPath in~ (\"/cat\", \"/head\", \"/tail\", \"/more\")) and ((ProcessCommandLine contains \"/.bash_history\" or ProcessCommandLine contains \"/.zsh_history\") or (ProcessCommandLine endswith \"_history\" or ProcessCommandLine endswith \".history\" or ProcessCommandLine endswith \"zhistory\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects usage of \"MSOHTMED\" to download arbitrary files Topic: proc_creation_win_msohtmed_download"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"ftp://\", \"http://\", \"https://\")) and (FolderPath endswith \"\\\\MSOHTMED.exe\" or ProcessVersionInfoOriginalFileName =~ \"MsoHtmEd.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential arbitrary file download using a Microsoft Office application Topic: proc_creation_win_office_arbitrary_cli_download"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"http://\", \"https://\")) and ((FolderPath endswith \"\\\\EXCEL.EXE\" or FolderPath endswith \"\\\\POWERPNT.EXE\" or FolderPath endswith \"\\\\WINWORD.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"Excel.exe\", \"POWERPNT.EXE\", \"WinWord.exe\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of \"vim\" and its siblings commands to execute a shell or proxy commands.\nSuch behavior may be associated with privilege escalation, unauthorized command execution, or to break out from restricted environments.\n Topic: proc_creation_lnx_vim_shell_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\":!/\", \":lua \", \":py \", \"/bin/bash\", \"/bin/dash\", \"/bin/fish\", \"/bin/sh\", \"/bin/zsh\")) and ((ProcessCommandLine in~ (\" --cmd\", \" -c \")) and (InitiatingProcessFolderPath in~ (\"/rvim\", \"/vim\", \"/vimdiff\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detect DLL deletions from Spooler Service driver folder. This might be a potential exploitation attempt of CVE-2021-1675 Topic: file_delete_win_cve_2021_1675_print_nightmare"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \"C:\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\x64\\\\3\\\\\" and InitiatingProcessFolderPath =~ \"\\\\spoolsv.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the usage of \"pypykatz\" to obtain stored credentials. Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database through Windows registry where the SAM database is stored Topic: proc_creation_win_hktl_pypykatz"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"live\", \"registry\")) and (InitiatingProcessFolderPath in~ (\"\\\\pypykatz.exe\", \"\\\\python.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system Topic: proc_creation_win_susp_network_scan_loop"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"for \", \"foreach \")) and (ProcessCommandLine in~ (\"nslookup\", \"ping\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects regsvr32 execution to download/install/register new DLLs that are hosted on Web or FTP servers. Topic: proc_creation_win_regsvr32_network_pattern"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\" /i\", \" -i\")) and (FolderPath endswith \"\\\\regsvr32.exe\" or ProcessVersionInfoOriginalFileName =~ \"REGSVR32.EXE\") and (ProcessCommandLine in~ (\"ftp\", \"http\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of \"Tpmvscmgr.exe\" to create a new virtual smart card. Topic: proc_creation_win_tpmvscmgr_add_virtual_smartcard"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"create\" and (ProcessVersionInfoOriginalFileName =~ \"TpmVscMgr.exe\" and InitiatingProcessFolderPath =~ \"\\\\tpmvscmgr.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors Topic: net_connection_lnx_ngrok_tunnel"}, {"role": "assistant", "content": "DeviceNetworkEvents\n| where RemoteUrl in~ (\"tunnel.us.ngrok.com\", \"tunnel.eu.ngrok.com\", \"tunnel.ap.ngrok.com\", \"tunnel.au.ngrok.com\", \"tunnel.sa.ngrok.com\", \"tunnel.jp.ngrok.com\", \"tunnel.in.ngrok.com\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects disabling security tools Topic: proc_creation_macos_disable_security_tools"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((FolderPath =~ \"/bin/launchctl\" and ProcessCommandLine =~ \"unload\") and (ProcessCommandLine in~ (\"com.objective-see.lulu.plist\", \"com.objective-see.blockblock.plist\", \"com.google.santad.plist\", \"com.carbonblack.defense.daemon.plist\", \"com.carbonblack.daemon.plist\", \"at.obdev.littlesnitchd.plist\", \"com.tenablesecurity.nessusagent.plist\", \"com.opendns.osx.RoamingClientConfigUpdater.plist\", \"com.crowdstrike.falcond.plist\", \"com.crowdstrike.userdaemon.plist\", \"osquery\", \"filebeat\", \"auditbeat\", \"packetbeat\", \"td-agent\"))) or (FolderPath =~ \"/usr/sbin/spctl\" and ProcessCommandLine =~ \"disable\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of whoami, which is often used by attackers after exploitation / privilege escalation Topic: proc_creation_win_whoami_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where FolderPath endswith \"\\\\whoami.exe\" or ProcessVersionInfoOriginalFileName =~ \"whoami.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious powershell process starts with base64 encoded commands (e.g. Emotet) Topic: proc_creation_win_powershell_base64_encoded_cmd"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((FolderPath endswith \"\\\\powershell.exe\" or FolderPath endswith \"\\\\pwsh.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"PowerShell.EXE\", \"pwsh.dll\"))) and (((ProcessCommandLine in~ (\" JAB\", \" SUVYI\", \" SQBFAFgA\", \" aQBlAHgA\", \" aWV4I\", \" IAA\", \" IAB\", \" UwB\", \" cwB\")) and ProcessCommandLine =~ \" -e\") or (ProcessCommandLine in~ (\".exe -ENCOD \", \" BA^J e-\"))) and (not(ProcessCommandLine =~ \" -ExecutionPolicy remotesigned \"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects usage of winget to add new additional download sources Topic: proc_creation_win_winget_add_custom_source"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"source \", \"add \")) and (FolderPath endswith \"\\\\winget.exe\" or ProcessVersionInfoOriginalFileName =~ \"winget.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of \"rundll32.exe\" with a parent process of Explorer.exe. This has been observed by variants of Raspberry Robin, as first reported by Red Canary. Topic: proc_creation_win_rundll32_parent_explorer"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((FolderPath endswith \"\\\\rundll32.exe\" or ProcessVersionInfoOriginalFileName =~ \"RUNDLL32.EXE\") and InitiatingProcessFileName =~ \"\\\\explorer.exe\") and (not((ProcessCommandLine contains \" C:\\\\Windows\\\\System32\\\\\" or ProcessCommandLine endswith \" -localserver 22d8c27b-47a1-48d1-ad08-7da7abd79617\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of SharpUp, a tool for local privilege escalation Topic: proc_creation_win_hktl_sharpup"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where FolderPath endswith \"\\\\SharpUp.exe\" or ProcessVersionInfoFileDescription =~ \"SharpUp\" or (ProcessCommandLine contains \"HijackablePaths\" or ProcessCommandLine contains \"UnquotedServicePath\" or ProcessCommandLine contains \"ProcessDLLHijack\" or ProcessCommandLine contains \"ModifiableServiceBinaries\" or ProcessCommandLine contains \"ModifiableScheduledTask\" or ProcessCommandLine contains \"DomainGPPPassword\" or ProcessCommandLine contains \"CachedGPPPassword\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious UltraVNC command line flag combination that indicate a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon threat group) Topic: proc_creation_win_ultravnc_susp_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"-autoreconnect \", \"-connect \", \"-id:\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of \"tar.exe\" in order to create a compressed file.\nAdversaries may abuse various utilities to compress or encrypt data before exfiltration.\n Topic: proc_creation_win_tar_compression"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"-c\", \"-r\", \"-u\")) and (FolderPath endswith \"\\\\tar.exe\" or ProcessVersionInfoOriginalFileName =~ \"bsdtar\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential network sniffing via use of network tools such as \"tshark\", \"windump\".\nNetwork sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection.\nAn adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.\n Topic: proc_creation_win_susp_network_sniffing"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine =~ \"-i\" and InitiatingProcessFolderPath =~ \"\\\\tshark.exe\") or InitiatingProcessFolderPath =~ \"\\\\windump.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of \"findstr\" to search for common names of security tools. Attackers often pipe the results of recon commands such as \"tasklist\" or \"whoami\" to \"findstr\" in order to filter out the results.\nThis detection focuses on the keywords that the attacker might use as a filter.\n Topic: proc_creation_win_findstr_security_keyword_lookup"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((FolderPath endswith \"\\\\find.exe\" or FolderPath endswith \"\\\\findstr.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"FIND.EXE\", \"FINDSTR.EXE\"))) and (ProcessCommandLine endswith \" avira\" or ProcessCommandLine endswith \" avira\\\"\" or ProcessCommandLine endswith \" cb\" or ProcessCommandLine endswith \" cb\\\"\" or ProcessCommandLine endswith \" cylance\" or ProcessCommandLine endswith \" cylance\\\"\" or ProcessCommandLine endswith \" defender\" or ProcessCommandLine endswith \" defender\\\"\" or ProcessCommandLine endswith \" kaspersky\" or ProcessCommandLine endswith \" kaspersky\\\"\" or ProcessCommandLine endswith \" kes\" or ProcessCommandLine endswith \" kes\\\"\" or ProcessCommandLine endswith \" mc\" or ProcessCommandLine endswith \" mc\\\"\" or ProcessCommandLine endswith \" sec\" or ProcessCommandLine endswith \" sec\\\"\" or ProcessCommandLine endswith \" sentinel\" or ProcessCommandLine endswith \" sentinel\\\"\" or ProcessCommandLine endswith \" symantec\" or ProcessCommandLine endswith \" symantec\\\"\" or ProcessCommandLine endswith \" virus\" or ProcessCommandLine endswith \" virus\\\"\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a WMI backdoor in Exchange Transport Agents via WMI event filters Topic: proc_creation_win_wmi_backdoor_exchange_transport_agent"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"\\\\EdgeTransport.exe\" and (not((FolderPath =~ \"C:\\\\Windows\\\\System32\\\\conhost.exe\" or InitiatingProcessFolderPath =~ \"\\\\Bin\\\\OleConverter.exe\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects file creation activity that is related to Diamond Sleet APT activity Topic: file_event_win_apt_diamond_sleet_indicators"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName in~ (\":\\\\ProgramData\\\\4800-84DC-063A6A41C5C\", \":\\\\ProgramData\\\\clip.exe\", \":\\\\ProgramData\\\\DSROLE.dll\", \":\\\\ProgramData\\\\Forest64.exe\", \":\\\\ProgramData\\\\readme.md\", \":\\\\ProgramData\\\\Version.dll\", \":\\\\ProgramData\\\\wsmprovhost.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of WinRAR in order to compress a file with a \".dmp\"/\".dump\" extension, which could be a step in a process of dump file exfiltration. Topic: proc_creation_win_winrar_exfil_dmp_files"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\".dmp\", \".dump\", \".hdmp\")) and ((FolderPath endswith \"\\\\rar.exe\" or FolderPath endswith \"\\\\winrar.exe\") or ProcessVersionInfoFileDescription =~ \"Command line RAR\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects file downloads directly from IP address URL using curl.exe Topic: proc_creation_win_curl_download_direct_ip_exec"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine in~ (\" -O\", \"--remote-name\", \"--output\")) and ProcessCommandLine =~ \"http\" and (FolderPath endswith \"\\\\curl.exe\" or ProcessVersionInfoOriginalFileName =~ \"curl.exe\") and ProcessCommandLine matches regex \"://[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\") and (not((ProcessCommandLine endswith \".bat\" or ProcessCommandLine endswith \".bat\\\"\" or ProcessCommandLine endswith \".dat\" or ProcessCommandLine endswith \".dat\\\"\" or ProcessCommandLine endswith \".dll\" or ProcessCommandLine endswith \".dll\\\"\" or ProcessCommandLine endswith \".exe\" or ProcessCommandLine endswith \".exe\\\"\" or ProcessCommandLine endswith \".gif\" or ProcessCommandLine endswith \".gif\\\"\" or ProcessCommandLine endswith \".hta\" or ProcessCommandLine endswith \".hta\\\"\" or ProcessCommandLine endswith \".jpeg\" or ProcessCommandLine endswith \".jpeg\\\"\" or ProcessCommandLine endswith \".log\" or ProcessCommandLine endswith \".log\\\"\" or ProcessCommandLine endswith \".msi\" or ProcessCommandLine endswith \".msi\\\"\" or ProcessCommandLine endswith \".png\" or ProcessCommandLine endswith \".png\\\"\" or ProcessCommandLine endswith \".ps1\" or ProcessCommandLine endswith \".ps1\\\"\" or ProcessCommandLine endswith \".psm1\" or ProcessCommandLine endswith \".psm1\\\"\" or ProcessCommandLine endswith \".vbe\" or ProcessCommandLine endswith \".vbe\\\"\" or ProcessCommandLine endswith \".vbs\" or ProcessCommandLine endswith \".vbs\\\"\" or ProcessCommandLine endswith \".bat'\" or ProcessCommandLine endswith \".dat'\" or ProcessCommandLine endswith \".dll'\" or ProcessCommandLine endswith \".exe'\" or ProcessCommandLine endswith \".gif'\" or ProcessCommandLine endswith \".hta'\" or ProcessCommandLine endswith \".jpeg'\" or ProcessCommandLine endswith \".log'\" or ProcessCommandLine endswith \".msi'\" or ProcessCommandLine endswith \".png'\" or ProcessCommandLine endswith \".ps1'\" or ProcessCommandLine endswith \".psm1'\" or ProcessCommandLine endswith \".vbe'\" or ProcessCommandLine endswith \".vbs'\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of different compiled Windows binaries of the impacket toolset (based on names or part of their names - could lead to false positives) Topic: proc_creation_win_hktl_impacket_tools"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (FolderPath contains \"\\\\goldenPac\" or FolderPath contains \"\\\\karmaSMB\" or FolderPath contains \"\\\\kintercept\" or FolderPath contains \"\\\\ntlmrelayx\" or FolderPath contains \"\\\\rpcdump\" or FolderPath contains \"\\\\samrdump\" or FolderPath contains \"\\\\secretsdump\" or FolderPath contains \"\\\\smbexec\" or FolderPath contains \"\\\\smbrelayx\" or FolderPath contains \"\\\\wmiexec\" or FolderPath contains \"\\\\wmipersist\") or (FolderPath endswith \"\\\\atexec_windows.exe\" or FolderPath endswith \"\\\\dcomexec_windows.exe\" or FolderPath endswith \"\\\\dpapi_windows.exe\" or FolderPath endswith \"\\\\findDelegation_windows.exe\" or FolderPath endswith \"\\\\GetADUsers_windows.exe\" or FolderPath endswith \"\\\\GetNPUsers_windows.exe\" or FolderPath endswith \"\\\\getPac_windows.exe\" or FolderPath endswith \"\\\\getST_windows.exe\" or FolderPath endswith \"\\\\getTGT_windows.exe\" or FolderPath endswith \"\\\\GetUserSPNs_windows.exe\" or FolderPath endswith \"\\\\ifmap_windows.exe\" or FolderPath endswith \"\\\\mimikatz_windows.exe\" or FolderPath endswith \"\\\\netview_windows.exe\" or FolderPath endswith \"\\\\nmapAnswerMachine_windows.exe\" or FolderPath endswith \"\\\\opdump_windows.exe\" or FolderPath endswith \"\\\\psexec_windows.exe\" or FolderPath endswith \"\\\\rdp_check_windows.exe\" or FolderPath endswith \"\\\\sambaPipe_windows.exe\" or FolderPath endswith \"\\\\smbclient_windows.exe\" or FolderPath endswith \"\\\\smbserver_windows.exe\" or FolderPath endswith \"\\\\sniff_windows.exe\" or FolderPath endswith \"\\\\sniffer_windows.exe\" or FolderPath endswith \"\\\\split_windows.exe\" or FolderPath endswith \"\\\\ticketer_windows.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects setting of a new registry value related to BgInfo configuration, which can be abused to execute custom VBScript via \"BgInfo.exe\" Topic: registry_set_bginfo_custom_vbscript"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where ActionType =~ \"RegistryValueSet\" and RegistryKey endswith \"\\\\Software\\\\Winternals\\\\BGInfo\\\\UserFields*\" and RegistryValueData startswith \"4\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a method to load DLL via LSASS process using an undocumented Registry key Topic: registry_event_susp_lsass_dll_load"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (RegistryKey contains \"\\\\CurrentControlSet\\\\Services\\\\NTDS\\\\DirectoryServiceExtPt\" or RegistryKey contains \"\\\\CurrentControlSet\\\\Services\\\\NTDS\\\\LsaDbExtPt\") and (not((InitiatingProcessFolderPath =~ \"C:\\\\Windows\\\\system32\\\\lsass.exe\" and (RegistryValueData in~ (\"%%systemroot%%\\\\system32\\\\ntdsa.dll\", \"%%systemroot%%\\\\system32\\\\lsadb.dll\")))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects Wscript/Cscript executing a file with an uncommon (i.e. non-script) extension Topic: proc_creation_win_wscript_cscript_uncommon_extension_exec"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\".csv\", \".dat\", \".doc\", \".gif\", \".jpeg\", \".jpg\", \".png\", \".ppt\", \".txt\", \".xls\", \".xml\")) and ((ProcessVersionInfoOriginalFileName in~ (\"wscript.exe\", \"cscript.exe\")) or (FolderPath endswith \"\\\\wscript.exe\" or FolderPath endswith \"\\\\cscript.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum Topic: registry_set_cve_2021_31979_cve_2021_33771_exploits"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (RegistryKey endswith \"CLSID\\\\{CF4CC405-E2C5-4DDD-B3CE-5E7582D8C9FA}\\\\InprocServer32\\\\(Default)\" or RegistryKey endswith \"CLSID\\\\{7C857801-7381-11CF-884D-00AA004B2E24}\\\\InProcServer32\\\\(Default)\") and (not((RegistryValueData endswith \"system32\\\\wbem\\\\wmiutils.dll\" or RegistryValueData endswith \"system32\\\\wbem\\\\wbemsvc.dll\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Files with well-known filenames (parts of credential dump software or files produced by them) creation Topic: file_event_win_cred_dump_tools_dropped_files"}, {"role": "assistant", "content": "DeviceFileEvents\n| where (FolderPath contains \"\\\\fgdump-log\" or FolderPath contains \"\\\\kirbi\" or FolderPath contains \"\\\\pwdump\" or FolderPath contains \"\\\\pwhashes\" or FolderPath contains \"\\\\wce_ccache\" or FolderPath contains \"\\\\wce_krbtkts\") or (FolderPath endswith \"\\\\cachedump.exe\" or FolderPath endswith \"\\\\cachedump64.exe\" or FolderPath endswith \"\\\\DumpExt.dll\" or FolderPath endswith \"\\\\DumpSvc.exe\" or FolderPath endswith \"\\\\Dumpy.exe\" or FolderPath endswith \"\\\\fgexec.exe\" or FolderPath endswith \"\\\\lsremora.dll\" or FolderPath endswith \"\\\\lsremora64.dll\" or FolderPath endswith \"\\\\NTDS.out\" or FolderPath endswith \"\\\\procdump64.exe\" or FolderPath endswith \"\\\\pstgdump.exe\" or FolderPath endswith \"\\\\pwdump.exe\" or FolderPath endswith \"\\\\SAM.out\" or FolderPath endswith \"\\\\SECURITY.out\" or FolderPath endswith \"\\\\servpw.exe\" or FolderPath endswith \"\\\\servpw64.exe\" or FolderPath endswith \"\\\\SYSTEM.out\" or FolderPath endswith \"\\\\test.pwd\" or FolderPath endswith \"\\\\wceaux.dll\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a file ending in jse, vbe, js, vba, vbs written by cscript.exe or wscript.exe Topic: file_event_win_cscript_wscript_dropper"}, {"role": "assistant", "content": "DeviceFileEvents\n| where (FileName in~ (\".jse\", \".vbe\", \".js\", \".vba\", \".vbs\")) and (InitiatingProcessFolderPath in~ (\"\\\\wscript.exe\", \"\\\\cscript.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects modification of autostart extensibility point (ASEP) in registry. Topic: registry_set_asep_reg_keys_modification_currentversion_nt"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey contains \"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" and (RegistryKey contains \"\\\\Winlogon\\\\VmApplet\" or RegistryKey contains \"\\\\Winlogon\\\\Userinit\" or RegistryKey contains \"\\\\Winlogon\\\\Taskman\" or RegistryKey contains \"\\\\Winlogon\\\\Shell\" or RegistryKey contains \"\\\\Winlogon\\\\GpExtensions\" or RegistryKey contains \"\\\\Winlogon\\\\AppSetup\" or RegistryKey contains \"\\\\Winlogon\\\\AlternateShells\\\\AvailableShells\" or RegistryKey contains \"\\\\Windows\\\\IconServiceLib\" or RegistryKey contains \"\\\\Windows\\\\Appinit_Dlls\" or RegistryKey contains \"\\\\Image File Execution Options\" or RegistryKey contains \"\\\\Font Drivers\" or RegistryKey contains \"\\\\Drivers32\" or RegistryKey contains \"\\\\Windows\\\\Run\" or RegistryKey contains \"\\\\Windows\\\\Load\") and (not((InitiatingProcessFolderPath =~ \"\\\\MicrosoftEdgeUpdate.exe\" or RegistryValueData =~ \"(Empty)\" or (RegistryKey endswith \"\\\\Image File Execution Options*\" and (RegistryKey endswith \"\\\\DisableExceptionChainValidation\" or RegistryKey endswith \"\\\\MitigationOptions\")) or ((RegistryKey endswith \"\\\\ClickToRunStore\\\\HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion*\" or RegistryKey endswith \"\\\\ClickToRun\\\\REGISTRY\\\\MACHINE\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion*\") or (InitiatingProcessFolderPath in~ (\"C:\\\\Program Files\\\\Microsoft Office\\\\root\\\\integration\\\\integrator.exe\", \"C:\\\\Program Files (x86)\\\\Microsoft Office\\\\root\\\\integration\\\\integrator.exe\"))) or InitiatingProcessFolderPath =~ \"\\\\ngen.exe\" or InitiatingProcessFolderPath =~ \"\\\\OfficeClickToRun.exe\" or (RegistryValueData endswith \"\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\Update\\\\OneDriveSetup.exe\\\"\" and RegistryValueData startswith \"C:\\\\Windows\\\\system32\\\\cmd.exe /q /c del /q \\\"C:\\\\Users\\\\\" and InitiatingProcessFolderPath =~ \"\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\StandaloneUpdater\\\\OneDriveSetup.exe\" and RegistryKey endswith \"\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\Delete Cached Update Binary\") or ((RegistryValueData in~ (\"DWORD (0x00000009)\", \"DWORD (0x000003c0)\")) and InitiatingProcessFolderPath =~ \"C:\\\\Windows\\\\system32\\\\svchost.exe\" and (RegistryKey contains \"\\\\Winlogon\\\\GPExtensions\\\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\\\PreviousPolicyAreas\" or RegistryKey contains \"\\\\Winlogon\\\\GPExtensions\\\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\\\MaxNoGPOListChangesInterval\")))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of the SharpLDAPmonitor. Which can monitor the creation, deletion and changes to LDAP objects. Topic: proc_creation_win_hktl_sharp_ldap_monitor"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"/user:\", \"/pass:\", \"/dcip:\")) or (FolderPath endswith \"\\\\SharpLDAPmonitor.exe\" or ProcessVersionInfoOriginalFileName =~ \"SharpLDAPmonitor.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects installation of a potentially suspicious new shim with an uncommon extension using sdbinst.exe.\nAdversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims\n Topic: proc_creation_win_sdbinst_susp_extension"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (FolderPath endswith \"\\\\sdbinst.exe\" or ProcessVersionInfoOriginalFileName =~ \"sdbinst.exe\") and (not((ProcessCommandLine =~ \"\" or ProcessCommandLine =~ \".sdb\" or ((ProcessCommandLine endswith \" -c\" or ProcessCommandLine endswith \" -f\" or ProcessCommandLine endswith \" -mm\" or ProcessCommandLine endswith \" -t\") or ProcessCommandLine contains \" -m -bg\") or isnull(ProcessCommandLine))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of a signed binary dropped by Kaspersky Lab Products Remover (kavremover) which can be abused as a LOLBIN to execute arbitrary commands and binaries. Topic: proc_creation_win_kavremover_uncommon_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \" run run-cmd \" and (not((InitiatingProcessFileName in~ (\"\\\\cleanapi.exe\", \"\\\\kavremover.exe\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious child processes of the SQLServer process. This could indicate potential RCE or SQL Injection. Topic: proc_creation_win_mssql_susp_child_process"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (InitiatingProcessFileName =~ \"\\\\sqlservr.exe\" and (InitiatingProcessFolderPath in~ (\"\\\\bash.exe\", \"\\\\bitsadmin.exe\", \"\\\\cmd.exe\", \"\\\\netstat.exe\", \"\\\\nltest.exe\", \"\\\\ping.exe\", \"\\\\powershell.exe\", \"\\\\pwsh.exe\", \"\\\\regsvr32.exe\", \"\\\\rundll32.exe\", \"\\\\sh.exe\", \"\\\\systeminfo.exe\", \"\\\\tasklist.exe\", \"\\\\wsl.exe\"))) and (not((ProcessCommandLine startswith \"\\\"C:\\\\Windows\\\\system32\\\\cmd.exe\\\" \" and FolderPath =~ \"C:\\\\Windows\\\\System32\\\\cmd.exe\" and InitiatingProcessFileName =~ \"C:\\\\Program Files\\\\Microsoft SQL Server\\\\\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects file access requests to Windows Outlook Mail by uncommon processes.\nCould indicate potential attempt of credential stealing.\nRequires heavy baselining before usage\n Topic: file_access_win_office_outlook_mail_credential"}, {"role": "assistant", "content": "DeviceFileEvents\n| where (FileName contains \"\\\\AppData\\\\Local\\\\Comms\\\\Unistore\\\\data\" or FileName endswith \"\\\\AppData\\\\Local\\\\Comms\\\\UnistoreDB\\\\store.vol\") and (not(((InitiatingProcessFolderPath in~ (\"C:\\\\Program Files (x86)\\\\\", \"C:\\\\Program Files\\\\\", \"C:\\\\Windows\\\\system32\\\\\", \"C:\\\\Windows\\\\SysWOW64\\\\\")) or InitiatingProcessFolderPath =~ \"System\"))) and (not(((InitiatingProcessFolderPath in~ (\"\\\\MpCopyAccelerator.exe\", \"\\\\MsMpEng.exe\")) or (InitiatingProcessFolderPath in~ (\"\\\\thor64.exe\", \"\\\\thor.exe\")))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of Microsoft bash launcher with the \"-c\" flag.\nThis can be used to potentially bypass defenses and execute Linux or Windows-based binaries directly via bash.\n Topic: proc_creation_win_bash_command_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \" -c \" and ((FolderPath endswith \":\\\\Windows\\\\System32\\\\bash.exe\" or FolderPath endswith \":\\\\Windows\\\\SysWOW64\\\\bash.exe\") or ProcessVersionInfoOriginalFileName =~ \"Bash.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects modification of autostart extensibility point (ASEP) in registry. Topic: registry_set_asep_reg_keys_modification_classes"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (RegistryKey contains \"\\\\Software\\\\Classes\" and (RegistryKey contains \"\\\\Folder\\\\ShellEx\\\\ExtShellFolderViews\" or RegistryKey contains \"\\\\Folder\\\\ShellEx\\\\DragDropHandlers\" or RegistryKey contains \"\\\\Folder\\\\Shellex\\\\ColumnHandlers\" or RegistryKey contains \"\\\\Filter\" or RegistryKey contains \"\\\\Exefile\\\\Shell\\\\Open\\\\Command\\\\(Default)\" or RegistryKey contains \"\\\\Directory\\\\Shellex\\\\DragDropHandlers\" or RegistryKey contains \"\\\\Directory\\\\Shellex\\\\CopyHookHandlers\" or RegistryKey contains \"\\\\CLSID\\\\{AC757296-3522-4E11-9862-C17BE5A1767E}\\\\Instance\" or RegistryKey contains \"\\\\CLSID\\\\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\\\\Instance\" or RegistryKey contains \"\\\\CLSID\\\\{7ED96837-96F0-4812-B211-F13C24117ED3}\\\\Instance\" or RegistryKey contains \"\\\\CLSID\\\\{083863F1-70DE-11d0-BD40-00A0C911CE86}\\\\Instance\" or RegistryKey contains \"\\\\Classes\\\\AllFileSystemObjects\\\\ShellEx\\\\DragDropHandlers\" or RegistryKey contains \"\\\\.exe\" or RegistryKey contains \"\\\\.cmd\" or RegistryKey contains \"\\\\ShellEx\\\\PropertySheetHandlers\" or RegistryKey contains \"\\\\ShellEx\\\\ContextMenuHandlers\")) and (not((RegistryValueData =~ \"(Empty)\" or RegistryValueData =~ \"{807583E5-5146-11D5-A672-00B0D022E945}\" or InitiatingProcessFolderPath =~ \"C:\\\\Windows\\\\System32\\\\drvinst.exe\" or (InitiatingProcessFolderPath =~ \"C:\\\\Windows\\\\System32\\\\svchost.exe\" and RegistryKey endswith \"\\\\lnkfile\\\\shellex\\\\ContextMenuHandlers*\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects patterns as noticed in exploitation of Serv-U CVE-2021-35211 vulnerability by threat group DEV-0322 Topic: proc_creation_win_exploit_cve_2021_35211_servu"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"whoami\" and ((ProcessCommandLine in~ (\"./Client/Common/\", \".\\\\Client\\\\Common\\\\\")) or ProcessCommandLine =~ \"C:\\\\Windows\\\\Temp\\\\Serv-U.bat\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects Russian group activity as described in Global Threat Report 2019 by Crowdstrike Topic: proc_creation_win_apt_bear_activity_gtr19"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"adexplorer -snapshot \\\"\\\" c:\\\\users\\\\\", \"\\\\downloads\\\\\", \".snp\")) or (ProcessCommandLine in~ (\"xcopy /S /E /C /Q /H \\\\\\\\\", \"\\\\sysvol\\\\\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects scheduled task creations or modification on a suspicious schedule type Topic: proc_creation_win_schtasks_schedule_type"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((FolderPath endswith \"\\\\schtasks.exe\" or ProcessVersionInfoOriginalFileName =~ \"schtasks.exe\") and (ProcessCommandLine in~ (\" ONLOGON \", \" ONSTART \", \" ONCE \", \" ONIDLE \"))) and (not((ProcessCommandLine in~ (\"NT AUT\", \" SYSTEM\", \"HIGHEST\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of a renamed SysInternals Sdelete, which is something an administrator shouldnt do (the renaming) Topic: proc_creation_win_renamed_sysinternals_sdelete"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessVersionInfoOriginalFileName =~ \"sdelete.exe\" and (not((InitiatingProcessFolderPath in~ (\"\\\\sdelete.exe\", \"\\\\sdelete64.exe\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects default PsExec service filename which indicates PsExec service installation and execution Topic: file_event_win_sysinternals_psexec_service"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \"\\\\PSEXESVC.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detect usage of the \"runexehelper.exe\" binary as a proxy to launch other programs Topic: proc_creation_win_lolbin_runexehelper"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"\\\\runexehelper.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects threat actors proxy executing code and bypassing application controls by leveraging wmic and the `/FORMAT` argument switch to download and execute an XSL file (i.e js, vbs, etc). Topic: image_load_wmic_remote_xsl_scripting_dlls"}, {"role": "assistant", "content": "DeviceImageLoadEvents\n| where (FolderPath endswith \"\\\\jscript.dll\" or FolderPath endswith \"\\\\vbscript.dll\") and InitiatingProcessFolderPath =~ \"\\\\wmic.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22) Topic: file_event_win_uac_bypass_consent_comctl32"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \"\\\\comctl32.dll\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of the \"wusa.exe\" (Windows Update Standalone Installer) utility by a parent process that is located in a suspicious location.\nAttackers could instantiate an instance of \"wusa.exe\" in order to bypass User Account Control (UAC). They can duplicate the access token from \"wusa.exe\" to gain elevated privileges.\n Topic: proc_creation_win_wusa_susp_parent_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFolderPath =~ \"\\\\wusa.exe\" and ((InitiatingProcessFileName in~ (\":\\\\Perflogs\\\\\", \":\\\\Users\\\\Public\\\\\", \":\\\\Windows\\\\Temp\\\\\", \"\\\\Appdata\\\\Local\\\\Temp\\\\\", \"\\\\Temporary Internet\")) or ((InitiatingProcessFolderPath contains \":\\\\Users\\\\\" and InitiatingProcessFolderPath contains \"\\\\Favorites\\\\\") or (InitiatingProcessFolderPath contains \":\\\\Users\\\\\" and InitiatingProcessFolderPath contains \"\\\\Favourites\\\\\") or (InitiatingProcessFolderPath contains \":\\\\Users\\\\\" and InitiatingProcessFolderPath contains \"\\\\Contacts\\\\\") or (InitiatingProcessFolderPath contains \":\\\\Users\\\\\" and InitiatingProcessFolderPath contains \"\\\\Pictures\\\\\"))) and (not(ProcessCommandLine =~ \".msu\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects files dropped by Winnti as described in RedMimicry Winnti playbook Topic: file_event_win_redmimicry_winnti_filedrop"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName in~ (\"\\\\gthread-3.6.dll\", \"\\\\sigcmm-2.4.dll\", \"\\\\Windows\\\\Temp\\\\tmp.bat\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects javaw.exe in AppData folder as used by Adwind / JRAT Topic: file_event_win_mal_adwind"}, {"role": "assistant", "content": "DeviceFileEvents\n| where (FolderPath contains \"\\\\AppData\\\\Roaming\\\\Oracle\\\\bin\\\\java\" and FolderPath contains \".exe\") or (FolderPath contains \"\\\\Retrive\" and FolderPath contains \".vbs\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the removal of Sysmon, which could be a potential attempt at defense evasion Topic: proc_creation_win_sysinternals_sysmon_uninstall"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((FolderPath endswith \"\\\\Sysmon64.exe\" or FolderPath endswith \"\\\\Sysmon.exe\") or ProcessVersionInfoFileDescription =~ \"System activity monitor\") and (ProcessCommandLine contains \"-u\" or ProcessCommandLine contains \"/u\" or ProcessCommandLine contains \"\u2013u\" or ProcessCommandLine contains \"\u2014u\" or ProcessCommandLine contains \"\u2015u\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects Stracciatella which executes a Powershell runspace from within C# (aka SharpPick technique) with AMSI, ETW and Script Block Logging disabled based on PE metadata characteristics. Topic: proc_creation_win_hktl_stracciatella_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where FolderPath endswith \"\\\\Stracciatella.exe\" or ProcessVersionInfoOriginalFileName =~ \"Stracciatella.exe\" or ProcessVersionInfoFileDescription =~ \"Stracciatella\" or (SHA256 startswith \"9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956\" or SHA256 startswith \"fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects findstring commands that include the keyword lsass, which indicates recon actviity for the LSASS process PID Topic: proc_creation_win_findstr_lsass"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine =~ \"lsass\" and ((FolderPath endswith \"\\\\find.exe\" or FolderPath endswith \"\\\\findstr.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"FIND.EXE\", \"FINDSTR.EXE\")))) or (ProcessCommandLine contains \" -i \\\"lsass\" or ProcessCommandLine contains \" /i \\\"lsass\" or ProcessCommandLine contains \" \u2013i \\\"lsass\" or ProcessCommandLine contains \" \u2014i \\\"lsass\" or ProcessCommandLine contains \" \u2015i \\\"lsass\" or ProcessCommandLine contains \" -i lsass.exe\" or ProcessCommandLine contains \" /i lsass.exe\" or ProcessCommandLine contains \" \u2013i lsass.exe\" or ProcessCommandLine contains \" \u2014i lsass.exe\" or ProcessCommandLine contains \" \u2015i lsass.exe\" or ProcessCommandLine contains \"findstr \\\"lsass\" or ProcessCommandLine contains \"findstr lsass\" or ProcessCommandLine contains \"findstr.exe \\\"lsass\" or ProcessCommandLine contains \"findstr.exe lsass\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of KrbRelay, a Kerberos relaying tool Topic: proc_creation_win_hktl_krbrelay"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\" -spn \", \" -clsid \", \" -rbcd \")) or (ProcessCommandLine in~ (\"shadowcred\", \"clsid\", \"spn\")) or (ProcessCommandLine in~ (\"spn \", \"session \", \"clsid \")) or (FolderPath endswith \"\\\\KrbRelay.exe\" or ProcessVersionInfoOriginalFileName =~ \"KrbRelay.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of GfxDownloadWrapper.exe with a URL as an argument to download file. Topic: proc_creation_win_gfxdownloadwrapper_arbitrary_file_download"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine in~ (\"http://\", \"https://\")) and InitiatingProcessFolderPath =~ \"\\\\GfxDownloadWrapper.exe\") and (not(ProcessCommandLine =~ \"https://gameplayapi.intel.com/\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of \"whoami.exe\" by privileged accounts that are often abused by threat actors Topic: proc_creation_win_whoami_execution_from_high_priv_process"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessVersionInfoOriginalFileName =~ \"whoami.exe\" or FolderPath endswith \"\\\\whoami.exe\") and (InitiatingProcessAccountName in~ (\"AUTHORI\", \"AUTORI\", \"TrustedInstaller\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of the Microsoft Windows Resource Leak Diagnostic tool \"rdrleakdiag.exe\" to dump process memory Topic: proc_creation_win_rdrleakdiag_process_dumping"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (FolderPath endswith \"\\\\rdrleakdiag.exe\" or ProcessVersionInfoOriginalFileName =~ \"RdrLeakDiag.exe\") and (ProcessCommandLine contains \"-memdmp\" or ProcessCommandLine contains \"/memdmp\" or ProcessCommandLine contains \"\u2013memdmp\" or ProcessCommandLine contains \"\u2014memdmp\" or ProcessCommandLine contains \"\u2015memdmp\" or ProcessCommandLine contains \"fullmemdmp\") and (ProcessCommandLine contains \" -o \" or ProcessCommandLine contains \" /o \" or ProcessCommandLine contains \" \u2013o \" or ProcessCommandLine contains \" \u2014o \" or ProcessCommandLine contains \" \u2015o \" or ProcessCommandLine contains \" -p \" or ProcessCommandLine contains \" /p \" or ProcessCommandLine contains \" \u2013p \" or ProcessCommandLine contains \" \u2014p \" or ProcessCommandLine contains \" \u2015p \")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects system discovery activity carried out by Pikabot, such as incl. network, user info and domain groups.\nThe malware Pikabot has been seen to use this technique as part of its C2-botnet registration with a short collection time frame (less than 1 minute).\n Topic: proc_creation_win_malware_pikabot_discovery"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (InitiatingProcessParentFileName endswith \"\\\\rundll32.exe\" or (InitiatingProcessFolderPath endswith \"\\\\SearchFilterHost.exe\" or InitiatingProcessFolderPath endswith \"\\\\SearchProtocolHost.exe\")) and (ProcessCommandLine in~ (\"ipconfig.exe /all\", \"netstat.exe -aon\", \"whoami.exe /all\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential DLL sideloading of \"EACore.dll\" Topic: image_load_side_load_eacore"}, {"role": "assistant", "content": "DeviceImageLoadEvents\n| where FolderPath endswith \"\\\\EACore.dll\" and (not(((InitiatingProcessFolderPath contains \"C:\\\\Program Files\\\\Electronic Arts\\\\EA Desktop\\\\\" and InitiatingProcessFolderPath contains \"\\\\EACoreServer.exe\") and FolderPath startswith \"C:\\\\Program Files\\\\Electronic Arts\\\\EA Desktop\\\\\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects events that appear when a user click on a link file with a powershell command in it Topic: proc_creation_win_susp_embed_exe_lnk"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where FolderPath =~ \"C:\\\\Windows\\\\System32\\\\cmd.exe\" and InitiatingProcessFileName =~ \"C:\\\\Windows\\\\explorer.exe\" and (ProcessCommandLine in~ (\"powershell\", \".lnk\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects exploitation attempt of privilege escalation vulnerability via SetupComplete.cmd and PartnerSetupComplete.cmd described in CVE-2019-1378 Topic: proc_creation_win_exploit_cve_2019_1378"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (InitiatingProcessCommandLine in~ (\"SetupComplete.cmd\", \"PartnerSetupComplete.cmd\")) and (not((InitiatingProcessFolderPath in~ (\"C:\\\\Windows\\\\System32\\\\\", \"C:\\\\Windows\\\\SysWOW64\\\\\", \"C:\\\\Windows\\\\WinSxS\\\\\", \"C:\\\\Windows\\\\Setup\\\\\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of shell scripts under the \"profile.d\" path. Topic: file_event_lnx_susp_shell_script_under_profile_directory"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName in~ (\".csh\", \".sh\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the usage of the unsafe bpftrace option Topic: proc_creation_lnx_bpftrace_unsafe_option_usage"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"--unsafe\" and InitiatingProcessFolderPath =~ \"bpftrace\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects possible malicious execution of JXA in-memory via OSAScript Topic: proc_creation_macos_jxa_in_memory_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine contains \" -l \" and ProcessCommandLine contains \"JavaScript\") or ProcessCommandLine contains \".js\") and (ProcessCommandLine in~ (\"osascript\", \" -e \", \"eval\", \"NSData.dataWithContentsOfURL\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential web shell execution from the ScreenConnect server process. Topic: proc_creation_win_remote_access_tools_screenconnect_webshell"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"\\\\ScreenConnect.Service.exe\" and (InitiatingProcessFolderPath in~ (\"\\\\cmd.exe\", \"\\\\csc.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Adversaries may acquire credentials from web browsers by reading files specific to the target browser.\nWeb browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future.\nWeb browsers typically store the credentials in an encrypted format within a credential store.\n Topic: proc_creation_win_susp_copy_browser_data"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine contains \"copy-item\" or ProcessCommandLine contains \"copy \" or ProcessCommandLine contains \"cpi \" or ProcessCommandLine contains \" cp \" or ProcessCommandLine contains \"move \" or ProcessCommandLine contains \"move-item\" or ProcessCommandLine contains \" mi \" or ProcessCommandLine contains \" mv \") or (FolderPath endswith \"\\\\xcopy.exe\" or FolderPath endswith \"\\\\robocopy.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"XCOPY.EXE\", \"robocopy.exe\"))) and (ProcessCommandLine in~ (\"\\\\Amigo\\\\User Data\", \"\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\", \"\\\\CentBrowser\\\\User Data\", \"\\\\Chromium\\\\User Data\", \"\\\\CocCoc\\\\Browser\\\\User Data\", \"\\\\Comodo\\\\Dragon\\\\User Data\", \"\\\\Elements Browser\\\\User Data\", \"\\\\Epic Privacy Browser\\\\User Data\", \"\\\\Google\\\\Chrome Beta\\\\User Data\", \"\\\\Google\\\\Chrome SxS\\\\User Data\", \"\\\\Google\\\\Chrome\\\\User Data\\\\\", \"\\\\Kometa\\\\User Data\", \"\\\\Maxthon5\\\\Users\", \"\\\\Microsoft\\\\Edge\\\\User Data\", \"\\\\Mozilla\\\\Firefox\\\\Profiles\", \"\\\\Nichrome\\\\User Data\", \"\\\\Opera Software\\\\Opera GX Stable\\\\\", \"\\\\Opera Software\\\\Opera Neon\\\\User Data\", \"\\\\Opera Software\\\\Opera Stable\\\\\", \"\\\\Orbitum\\\\User Data\", \"\\\\QIP Surf\\\\User Data\", \"\\\\Sputnik\\\\User Data\", \"\\\\Torch\\\\User Data\", \"\\\\uCozMedia\\\\Uran\\\\User Data\", \"\\\\Vivaldi\\\\User Data\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects when verclsid.exe is used to run COM object via GUID Topic: proc_creation_win_verclsid_runs_com"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"/S\", \"/C\")) and (FolderPath endswith \"\\\\verclsid.exe\" or ProcessVersionInfoOriginalFileName =~ \"verclsid.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it Topic: registry_set_new_network_provider"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (RegistryKey endswith \"\\\\System\\\\CurrentControlSet\\\\Services*\" and RegistryKey contains \"\\\\NetworkProvider\") and (not(((RegistryKey contains \"\\\\System\\\\CurrentControlSet\\\\Services\\\\WebClient\\\\NetworkProvider\" or RegistryKey contains \"\\\\System\\\\CurrentControlSet\\\\Services\\\\LanmanWorkstation\\\\NetworkProvider\" or RegistryKey contains \"\\\\System\\\\CurrentControlSet\\\\Services\\\\RDPNP\\\\NetworkProvider\") or InitiatingProcessFolderPath =~ \"C:\\\\Windows\\\\System32\\\\poqexec.exe\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.\nThe data may also be sent to an alternate network location from the main command and control server.\n Topic: net_connection_win_susp_outbound_smtp_connections"}, {"role": "assistant", "content": "DeviceNetworkEvents\n| where (InitiatingProcessId =~ \"true\" and (RemotePort in~ (\"25\", \"587\", \"465\", \"2525\"))) and (not(((InitiatingProcessFolderPath in~ (\"\\\\thunderbird.exe\", \"\\\\outlook.exe\")) or InitiatingProcessFolderPath =~ \"C:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\\" or InitiatingProcessFolderPath =~ \"C:\\\\Program Files\\\\WindowsApps\\\\microsoft.windowscommunicationsapps_\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a script interpreter (Wscript/Cscript) initiating a local network connection to download or execute a script hosted on a shared folder.\n Topic: net_connection_win_wscript_cscript_local_connection"}, {"role": "assistant", "content": "DeviceNetworkEvents\n| where InitiatingProcessId =~ \"true\" and (InitiatingProcessRemoteSessionDeviceName in~ (\"127.0.0.0/8\", \"10.0.0.0/8\", \"172.16.0.0/12\", \"192.168.0.0/16\", \"169.254.0.0/16\", \"::1/128\", \"fe80::/10\", \"fc00::/7\")) and (InitiatingProcessFolderPath in~ (\"\\\\wscript.exe\", \"\\\\cscript.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potentially suspicious child processes of \"Diskshadow.exe\". This could be an attempt to bypass parent/child relationship detection or application whitelisting rules. Topic: proc_creation_win_diskshadow_child_process_susp"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"\\\\diskshadow.exe\" and (InitiatingProcessFolderPath in~ (\"\\\\certutil.exe\", \"\\\\cscript.exe\", \"\\\\mshta.exe\", \"\\\\powershell.exe\", \"\\\\pwsh.exe\", \"\\\\regsvr32.exe\", \"\\\\rundll32.exe\", \"\\\\wscript.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation Topic: proc_creation_win_hwp_exploits"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFileName =~ \"\\\\Hwp.exe\" and InitiatingProcessFolderPath =~ \"\\\\gbb.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of the \"mofcomp\" utility as a child of a suspicious shell or script running utility or by having a suspicious path in the commandline.\nThe \"mofcomp\" utility parses a file containing MOF statements and adds the classes and class instances defined in the file to the WMI repository.\nAttackers abuse this utility to install malicious MOF scripts\n Topic: proc_creation_win_mofcomp_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (((InitiatingProcessFolderPath endswith \"\\\\cmd.exe\" or InitiatingProcessFolderPath endswith \"\\\\powershell.exe\" or InitiatingProcessFolderPath endswith \"\\\\pwsh.exe\" or InitiatingProcessFolderPath endswith \"\\\\wsl.exe\" or InitiatingProcessFolderPath endswith \"\\\\wscript.exe\" or InitiatingProcessFolderPath endswith \"\\\\cscript.exe\") or (ProcessCommandLine contains \"\\\\AppData\\\\Local\\\\Temp\" or ProcessCommandLine contains \"\\\\Users\\\\Public\\\\\" or ProcessCommandLine contains \"\\\\WINDOWS\\\\Temp\\\\\" or ProcessCommandLine contains \"%temp%\" or ProcessCommandLine contains \"%tmp%\" or ProcessCommandLine contains \"%appdata%\")) and (FolderPath endswith \"\\\\mofcomp.exe\" or ProcessVersionInfoOriginalFileName =~ \"mofcomp.exe\")) and (not((ProcessCommandLine endswith \".mof\" and InitiatingProcessFileName =~ \"C:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\" and ProcessCommandLine =~ \"C:\\\\Windows\\\\TEMP\\\\\"))) and (not((ProcessCommandLine has_all (\"C:\\\\Windows\\\\TEMP\\\\\") and ProcessCommandLine endswith \".mof\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects passwords dumps from Keychain Topic: proc_creation_macos_creds_from_keychain"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (FolderPath =~ \"/usr/bin/security\" and (ProcessCommandLine in~ (\"find-certificate\", \" export \"))) or (ProcessCommandLine in~ (\" dump-keychain \", \" login-keychain \"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects macOS Gatekeeper bypass via xattr utility Topic: proc_creation_macos_xattr_gatekeeper_bypass"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"-d\", \"com.apple.quarantine\")) and InitiatingProcessFolderPath =~ \"/xattr\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential DLL sideloading of \"SmadHook.dll\", a DLL used by SmadAV antivirus Topic: image_load_side_load_smadhook"}, {"role": "assistant", "content": "DeviceImageLoadEvents\n| where (FolderPath endswith \"\\\\SmadHook32c.dll\" or FolderPath endswith \"\\\\SmadHook64c.dll\") and (not(((InitiatingProcessFolderPath in~ (\"C:\\\\Program Files (x86)\\\\SMADAV\\\\SmadavProtect32.exe\", \"C:\\\\Program Files (x86)\\\\SMADAV\\\\SmadavProtect64.exe\", \"C:\\\\Program Files\\\\SMADAV\\\\SmadavProtect32.exe\", \"C:\\\\Program Files\\\\SMADAV\\\\SmadavProtect64.exe\")) and (FolderPath startswith \"C:\\\\Program Files (x86)\\\\SMADAV\\\\\" or FolderPath startswith \"C:\\\\Program Files\\\\SMADAV\\\\\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious interactive bash as a parent to rather uncommon child processes Topic: proc_creation_lnx_susp_interactive_bash"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessCommandLine =~ \"bash -i\" and ((ProcessCommandLine in~ (\"-c import \", \"base64\", \"pty.spawn\")) or (InitiatingProcessFolderPath in~ (\"whoami\", \"iptables\", \"/ncat\", \"/nc\", \"/netcat\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects filename pattern of email related data used by UNC4841 for staging and exfiltration Topic: file_event_lnx_apt_unc4841_exfil_mail_pattern"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \"/mail/tmp/[a-zA-Z0-9]{3}[0-9]{3}\\\\.tar\\\\.gz\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious mshta process execution patterns Topic: proc_creation_win_mshta_susp_pattern"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((FolderPath endswith \"\\\\mshta.exe\" or ProcessVersionInfoOriginalFileName =~ \"MSHTA.EXE\") and ((InitiatingProcessFileName in~ (\"\\\\cmd.exe\", \"\\\\cscript.exe\", \"\\\\powershell.exe\", \"\\\\pwsh.exe\", \"\\\\regsvr32.exe\", \"\\\\rundll32.exe\", \"\\\\wscript.exe\")) and (ProcessCommandLine in~ (\"\\\\AppData\\\\Local\\\\\", \"C:\\\\ProgramData\\\\\", \"C:\\\\Users\\\\Public\\\\\", \"C:\\\\Windows\\\\Temp\\\\\")))) or ((FolderPath endswith \"\\\\mshta.exe\" or ProcessVersionInfoOriginalFileName =~ \"MSHTA.EXE\") and (not(((FolderPath startswith \"C:\\\\Windows\\\\System32\\\\\" or FolderPath startswith \"C:\\\\Windows\\\\SysWOW64\\\\\") or (ProcessCommandLine contains \".htm\" or ProcessCommandLine contains \".hta\") or (ProcessCommandLine endswith \"mshta.exe\" or ProcessCommandLine endswith \"mshta\")))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects usage of namp/zenmap. Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation Topic: proc_creation_win_pua_nmap_zenmap"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (FolderPath endswith \"\\\\nmap.exe\" or FolderPath endswith \"\\\\zennmap.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"nmap.exe\", \"zennmap.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of a file with the name \"code_tunnel.json\" which indicate execution and usage of VsCode tunneling utility. Attackers can abuse this functionality to establish a C2 channel\n Topic: file_event_win_vscode_tunnel_indicators"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \"\\\\code_tunnel.json\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects PowerShell writing startup shortcuts.\nThis procedure was highlighted in Red Canary Intel Insights Oct. 2021, \"We frequently observe adversaries using PowerShell to write malicious .lnk files into the startup directory to establish persistence.\nAccordingly, this detection opportunity is likely to identify persistence mechanisms in multiple threats.\nIn the context of Yellow Cockatoo, this persistence mechanism eventually launches the command-line script that leads to the installation of a malicious DLL\"\n Topic: file_event_win_powershell_startup_shortcuts"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \".lnk\" and (InitiatingProcessFolderPath in~ (\"\\\\powershell.exe\", \"\\\\pwsh.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects Non-Standard tools initiating a connection over port 3389 indicating possible lateral movement.\nAn initial baseline is required before using this utility to exclude third party RDP tooling that you might use.\n Topic: net_connection_win_rdp_outbound_over_non_standard_tools"}, {"role": "assistant", "content": "DeviceNetworkEvents\n| where (InitiatingProcessId =~ \"true\" and RemotePort == 3389) and (not((InitiatingProcessFolderPath in~ (\"C:\\\\Windows\\\\System32\\\\mstsc.exe\", \"C:\\\\Windows\\\\SysWOW64\\\\mstsc.exe\")))) and (not(((InitiatingProcessFolderPath in~ (\"\\\\Avast Software\\\\Avast\\\\AvastSvc.exe\", \"\\\\Avast\\\\AvastSvc.exe\")) or InitiatingProcessFolderPath =~ \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\" or (InitiatingProcessFolderPath =~ \"C:\\\\Windows\\\\System32\\\\dns.exe\" and Protocol =~ \"udp\" and LocalPort == 53) or InitiatingProcessFolderPath =~ \"\" or InitiatingProcessFolderPath =~ \"C:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe\" or isnull(InitiatingProcessFolderPath) or InitiatingProcessFolderPath =~ \"\\\\Ranger\\\\SentinelRanger.exe\" or InitiatingProcessFolderPath =~ \"C:\\\\Program Files\\\\SplunkUniversalForwarder\\\\bin\\\\\" or InitiatingProcessFolderPath =~ \"\\\\RDCMan.exe\" or (InitiatingProcessFolderPath in~ (\"\\\\FSAssessment.exe\", \"\\\\FSDiscovery.exe\", \"\\\\MobaRTE.exe\", \"\\\\mRemote.exe\", \"\\\\mRemoteNG.exe\", \"\\\\Passwordstate.exe\", \"\\\\RemoteDesktopManager.exe\", \"\\\\RemoteDesktopManager64.exe\", \"\\\\RemoteDesktopManagerFree.exe\", \"\\\\RSSensor.exe\", \"\\\\RTS2App.exe\", \"\\\\RTSApp.exe\", \"\\\\spiceworks-finder.exe\", \"\\\\Terminals.exe\", \"\\\\ws_TunnelService.exe\")) or (InitiatingProcessFolderPath in~ (\"\\\\thor.exe\", \"\\\\thor64.exe\")) or (InitiatingProcessFolderPath in~ (\"C:\\\\Program Files\\\\TSplus\\\\Java\\\\bin\\\\HTML5service.exe\", \"C:\\\\Program Files (x86)\\\\TSplus\\\\Java\\\\bin\\\\HTML5service.exe\")) or InitiatingProcessFolderPath =~ \"<unknown process>\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Attackers can use print.exe for remote file copy Topic: proc_creation_win_print_remote_file_copy"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine startswith \"print\" and (ProcessCommandLine in~ (\"/D\", \".exe\")) and InitiatingProcessFolderPath =~ \"\\\\print.exe\") and (not(ProcessCommandLine =~ \"print.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of the \"finger.exe\" utility.\nFinger.EXE or \"TCPIP Finger Command\" is an old utility that is still present on modern Windows installation. It Displays information about users on a specified remote computer (typically a UNIX computer) that is running the finger service or daemon.\nDue to the old nature of this utility and the rareness of machines having the finger service. Any execution of \"finger.exe\" can be considered \"suspicious\" and worth investigating.\n Topic: proc_creation_win_finger_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessVersionInfoOriginalFileName =~ \"finger.exe\" or FolderPath endswith \"\\\\finger.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of the LaZagne. A utility used to retrieve multiple types of passwords stored on a local computer.\nLaZagne has been leveraged multiple times by threat actors in order to dump credentials.\n Topic: proc_creation_win_hktl_lazagne"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFolderPath =~ \"\\\\lazagne.exe\" or ((ProcessCommandLine endswith \".exe all\" or ProcessCommandLine endswith \".exe browsers\" or ProcessCommandLine endswith \".exe chats\" or ProcessCommandLine endswith \".exe databases\" or ProcessCommandLine endswith \".exe games\" or ProcessCommandLine endswith \".exe git\" or ProcessCommandLine endswith \".exe mails\" or ProcessCommandLine endswith \".exe maven\" or ProcessCommandLine endswith \".exe memory\" or ProcessCommandLine endswith \".exe multimedia\" or ProcessCommandLine endswith \".exe sysadmin\" or ProcessCommandLine endswith \".exe unused\" or ProcessCommandLine endswith \".exe wifi\" or ProcessCommandLine endswith \".exe windows\") and (FolderPath contains \":\\\\PerfLogs\\\\\" or FolderPath contains \":\\\\ProgramData\\\\\" or FolderPath contains \":\\\\Temp\\\\\" or FolderPath contains \":\\\\Tmp\\\\\" or FolderPath contains \":\\\\Windows\\\\Temp\\\\\" or FolderPath contains \"\\\\AppData\\\\\" or FolderPath contains \"\\\\Downloads\\\\\" or FolderPath contains \"\\\\Users\\\\Public\\\\\")) or ((ProcessCommandLine in~ (\"all \", \"browsers \", \"chats \", \"databases \", \"games \", \"git \", \"mails \", \"maven \", \"memory \", \"multimedia \", \"php \", \"svn \", \"sysadmin \", \"unused \", \"wifi \", \"windows \")) and (ProcessCommandLine in~ (\"-oA\", \"-oJ\", \"-oN\", \"-output\", \"-password\", \"-1Password\", \"-apachedirectorystudio\", \"-autologon\", \"-ChromiumBased\", \"-composer\", \"-coreftp\", \"-credfiles\", \"-credman\", \"-cyberduck\", \"-dbvis\", \"-EyeCon\", \"-filezilla\", \"-filezillaserver\", \"-ftpnavigator\", \"-galconfusion\", \"-gitforwindows\", \"-hashdump\", \"-iisapppool\", \"-IISCentralCertP\", \"-kalypsomedia\", \"-keepass\", \"-keepassconfig\", \"-lsa_secrets\", \"-mavenrepositories\", \"-memory_dump\", \"-Mozilla\", \"-mRemoteNG\", \"-mscache\", \"-opensshforwindows\", \"-openvpn\", \"-outlook\", \"-pidgin\", \"-postgresql\", \"-psi-im\", \"-puttycm\", \"-pypykatz\", \"-Rclone\", \"-rdpmanager\", \"-robomongo\", \"-roguestale\", \"-skype\", \"-SQLDeveloper\", \"-squirrel\", \"-tortoise\", \"-turba\", \"-UCBrowser\", \"-unattended\", \"-vault\", \"-vaultfiles\", \"-vnc\", \"-windows\", \"-winscp\", \"-wsl\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects signs of the WMI script host process \"scrcons.exe\" loading scripting DLLs which could indicates WMI ActiveScriptEventConsumers EventConsumers activity. Topic: image_load_scrcons_wmi_scripteventconsumer"}, {"role": "assistant", "content": "DeviceImageLoadEvents\n| where (FolderPath endswith \"\\\\vbscript.dll\" or FolderPath endswith \"\\\\wbemdisp.dll\" or FolderPath endswith \"\\\\wshom.ocx\" or FolderPath endswith \"\\\\scrrun.dll\") and InitiatingProcessFolderPath =~ \"\\\\scrcons.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "One way Qbot steals sensitive information is by extracting browser data from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe Topic: proc_creation_win_esentutl_webcache"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine contains \"-r\" or ProcessCommandLine contains \"/r\" or ProcessCommandLine contains \"\u2013r\" or ProcessCommandLine contains \"\u2014r\" or ProcessCommandLine contains \"\u2015r\") and (FolderPath endswith \"\\\\esentutl.exe\" or ProcessVersionInfoOriginalFileName =~ \"esentutl.exe\") and ProcessCommandLine =~ \"\\\\Windows\\\\WebCache\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the pattern of UAC Bypass using Event Viewer RecentViews Topic: proc_creation_win_uac_bypass_eventvwr_recentviews"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\"\\\\Event Viewer\\\\RecentViews\", \"\\\\EventV~1\\\\RecentViews\")) and ProcessCommandLine =~ \">\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of the AgentExecutor.exe binary. Which can be abused as a LOLBIN to execute powershell scripts with the ExecutionPolicy \"Bypass\" or any binary named \"powershell.exe\" located in the path provided by 6th positional argument Topic: proc_creation_win_agentexecutor_susp_usage"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine in~ (\" -powershell\", \" -remediationScript\")) and (FolderPath endswith \"\\\\AgentExecutor.exe\" or ProcessVersionInfoOriginalFileName =~ \"AgentExecutor.exe\")) and (not((InitiatingProcessFileName =~ \"\\\\Microsoft.Management.Services.IntuneWindowsAgent.exe\" or (ProcessCommandLine in~ (\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\\", \"C:\\\\Windows\\\\SysWOW64\\\\WindowsPowerShell\\\\v1.0\\\\\")))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of \"msdt.exe\" using an answer file which is simulating the legitimate way of calling msdt via \"pcwrun.exe\" (For example from the compatibility tab) Topic: proc_creation_win_lolbin_msdt_answer_file"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine in~ (\" -af \", \" /af \")) and (ProcessCommandLine =~ \"\\\\WINDOWS\\\\diagnostics\\\\index\\\\PCWDiagnostic.xml\" and InitiatingProcessFolderPath =~ \"\\\\msdt.exe\")) and (not(InitiatingProcessFileName =~ \"\\\\pcwrun.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potentially suspicious child process of SSH process (sshd) with a specific execution user. This could be a sign of potential exploitation of CVE-2024-3094.\n Topic: proc_creation_lnx_exploit_cve_2024_3094_sshd_child_process"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine startswith \"bash -c\" or ProcessCommandLine startswith \"sh -c\") and InitiatingProcessFileName =~ \"/sshd\" and AccountName =~ \"root\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects installation of new certificate on the system which attackers may use to avoid warnings when connecting to controlled web servers or C2s Topic: proc_creation_lnx_install_root_certificate"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFolderPath in~ (\"/update-ca-certificates\", \"/update-ca-trust\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects changes to the Netsh registry key to add a new DLL value. This change might be an indication of a potential persistence attempt by adding a malicious Netsh helper\n Topic: registry_set_netsh_helper_dll_potential_persistence"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey contains \"\\\\SOFTWARE\\\\Microsoft\\\\NetSh\" and RegistryValueData contains \".dll\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects calls to cmdlets that are used to export certificates from the local certificate store. Threat actors were seen abusing this to steal private keys from compromised machines. Topic: proc_creation_win_powershell_export_certificate"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"Export-PfxCertificate \", \"Export-Certificate \")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects a specific command line of \"regsvr32\" where the \"calc\" keyword is used in conjunction with the \"/s\" flag. This behavior is often seen used by Qakbot Topic: proc_creation_win_malware_qakbot_regsvr32_calc_pattern"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine contains \" -s\" or ProcessCommandLine contains \" /s\" or ProcessCommandLine contains \" \u2013s\" or ProcessCommandLine contains \" \u2014s\" or ProcessCommandLine contains \" \u2015s\") and ProcessCommandLine endswith \" calc\" and InitiatingProcessFolderPath =~ \"\\\\regsvr32.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of NPS, a port forwarding and intranet penetration proxy server Topic: proc_creation_win_pua_nps"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\" -server=\", \" -vkey=\", \" -password=\")) or ProcessCommandLine =~ \" -config=npc\" or (MD5 startswith \"AE8ACF66BFE3A44148964048B826D005\" or SHA1 startswith \"CEA49E9B9B67F3A13AD0BE1C2655293EA3C18181\" or SHA256 startswith \"5A456283392FFCEEEACA3D3426C306EB470304637520D72FED1CC1FEBBBD6856\") or InitiatingProcessFolderPath =~ \"\\\\npc.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects usage of nohup which could be leveraged by an attacker to keep a process running or break out from restricted environments Topic: proc_creation_lnx_nohup"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFolderPath =~ \"/nohup\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects usage of the Get-Clipboard cmdlet via CLI Topic: proc_creation_win_powershell_get_clipboard"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"Get-Clipboard\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of the \"net.exe\" command in order to add a group named \"ESX Admins\".\nThis could indicates a potential exploitation attempt of CVE-2024-37085, which allows an attacker to elevate their privileges to full administrative access on an domain-joined ESXi hypervisor.\nVMware ESXi hypervisors joined to an Active Directory domain consider any member of a domain group named \"ESX Admins\" to have full administrative access by default.\n Topic: proc_creation_win_exploit_cve_2024_37085_esxi_admins_group_creation"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ((ProcessCommandLine in~ (\"/add\", \"/domain\", \"ESX Admins\", \"group\")) and ((FolderPath endswith \"\\\\net.exe\" or FolderPath endswith \"\\\\net1.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"net.exe\", \"net1.exe\")))) or ((ProcessCommandLine in~ (\"New-ADGroup\", \"ESX Admins\")) and ((FolderPath endswith \"\\\\PowerShell.exe\" or FolderPath endswith \"\\\\pwsh.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"PowerShell.exe\", \"pwsh.dll\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of the hacktool SharPersist - used to deploy various different kinds of persistence mechanisms Topic: proc_creation_win_hktl_sharpersist"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine in~ (\" -t schtask -c \", \" -t startupfolder -c \")) or (ProcessCommandLine in~ (\" -t reg -c \", \" -m add\")) or (ProcessCommandLine in~ (\" -t service -c \", \" -m add\")) or (ProcessCommandLine in~ (\" -t schtask -c \", \" -m add\")) or (FolderPath endswith \"\\\\SharPersist.exe\" or ProcessVersionInfoProductName =~ \"SharPersist\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects activity that indicates a user disabling the ability for Antivirus mini filter to inspect a \"Dev Drive\".\n Topic: registry_set_devdrv_disallow_antivirus_filter"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey endswith \"\\\\FilterManager\\\\FltmgrDevDriveAllowAntivirusFilter\" and RegistryValueData =~ \"DWORD (0x00000000)\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential persistence activity via outlook today page.\nAn attacker can set a custom page to execute arbitrary code and link to it via the registry values \"URL\" and \"UserDefinedUrl\".\n Topic: registry_set_persistence_outlook_todaypage"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where (RegistryKey endswith \"Software\\\\Microsoft\\\\Office*\" and RegistryKey endswith \"\\\\Outlook\\\\Today*\") and ((RegistryValueData =~ \"DWORD (0x00000001)\" and RegistryKey endswith \"\\\\Stamp\") or (RegistryKey endswith \"\\\\URL\" or RegistryKey endswith \"\\\\UserDefinedUrl\")) and (not(InitiatingProcessFolderPath =~ \"\\\\OfficeClickToRun.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of the builtin \"copy\" command that targets a shadow copy (sometimes used to copy registry hives that are in use) Topic: proc_creation_win_cmd_shadowcopy_access"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"copy \", \"\\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "HxTsr.exe is a Microsoft compressed executable file called Microsoft Outlook Communications.\nHxTsr.exe is part of Outlook apps, because it resides in a hidden \"WindowsApps\" subfolder of \"C:\\Program Files\".\nAny instances of hxtsr.exe not in this folder may be malware camouflaging itself as HxTsr.exe\n Topic: proc_creation_win_hxtsr_masquerading"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessFolderPath =~ \"\\\\hxtsr.exe\" and (not((FolderPath contains \":\\\\program files\\\\windowsapps\\\\microsoft.windowscommunicationsapps_\" and InitiatingProcessFolderPath =~ \"\\\\hxtsr.exe\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects suspicious Windows Update Agent activity in which a wuauclt.exe process command line doesnt contain any command line flags\n Topic: proc_creation_win_wuauclt_no_cli_flags_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (FolderPath endswith \"\\\\Wuauclt.exe\" or ProcessVersionInfoOriginalFileName =~ \"Wuauclt.exe\") and (ProcessCommandLine endswith \"Wuauclt\" or ProcessCommandLine endswith \"Wuauclt.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects default RemCom service filename which indicates RemCom service installation and execution Topic: file_event_win_remcom_service"}, {"role": "assistant", "content": "DeviceFileEvents\n| where FileName =~ \"\\\\RemComSvc.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects adding and using Exchange PowerShell snap-ins to export mailbox data. As seen used by HAFNIUM and APT27 Topic: proc_creation_win_powershell_snapins_hafnium"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (ProcessCommandLine =~ \"Add-PSSnapin\" and ((FolderPath endswith \"\\\\powershell.exe\" or FolderPath endswith \"\\\\pwsh.exe\") or (ProcessVersionInfoOriginalFileName in~ (\"PowerShell.EXE\", \"pwsh.dll\"))) and (ProcessCommandLine in~ (\"Microsoft.Exchange.Powershell.Snapin\", \"Microsoft.Exchange.Management.PowerShell.SnapIn\"))) and (not((InitiatingProcessFileName =~ \"C:\\\\Windows\\\\System32\\\\msiexec.exe\" and ProcessCommandLine =~ \"$exserver=Get-ExchangeServer ([Environment]::MachineName) -ErrorVariable exerr 2> $null\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the execution of a system command via the ScreenConnect RMM service. Topic: proc_creation_win_remote_access_tools_screenconnect_remote_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine =~ \"\\\\TEMP\\\\ScreenConnect\\\\\" and (FolderPath endswith \"\\\\cmd.exe\" or ProcessVersionInfoOriginalFileName =~ \"Cmd.Exe\") and InitiatingProcessFileName =~ \"\\\\ScreenConnect.ClientService.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of Windows Credential Editor (WCE) Topic: registry_event_hack_wce_reg"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey contains \"Services\\\\WCESERVICE\\\\Start\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Executes SCT script using scrobj.dll from a command in entered into a specially prepared INF file. Topic: proc_creation_win_infdefaultinstall_execute_sct_scripts"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"InfDefaultInstall.exe \", \".inf\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects programs that connect to known malware callback ports based on statistical analysis from two different sandbox system databases\n Topic: net_connection_win_susp_malware_callback_port"}, {"role": "assistant", "content": "DeviceNetworkEvents\n| where (InitiatingProcessId =~ \"true\" and (RemotePort in~ (\"100\", \"198\", \"200\", \"243\", \"473\", \"666\", \"700\", \"743\", \"777\", \"1443\", \"1515\", \"1777\", \"1817\", \"1904\", \"1960\", \"2443\", \"2448\", \"3360\", \"3675\", \"3939\", \"4040\", \"4433\", \"4438\", \"4443\", \"4444\", \"4455\", \"5445\", \"5552\", \"5649\", \"6625\", \"7210\", \"7777\", \"8143\", \"8843\", \"9631\", \"9943\", \"10101\", \"12102\", \"12103\", \"12322\", \"13145\", \"13394\", \"13504\", \"13505\", \"13506\", \"13507\", \"14102\", \"14103\", \"14154\", \"49180\", \"65520\", \"65535\"))) and (not((InitiatingProcessRemoteSessionDeviceName in~ (\"127.0.0.0/8\", \"10.0.0.0/8\", \"172.16.0.0/12\", \"192.168.0.0/16\", \"169.254.0.0/16\", \"::1/128\", \"fe80::/10\", \"fc00::/7\")))) and (not((InitiatingProcessFolderPath in~ (\"C:\\\\Program Files\\\\\", \"C:\\\\Program Files (x86)\\\\\"))))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects execution of ChromeLoader malware via a registered scheduled task Topic: proc_creation_win_malware_chrome_loader_execution"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where InitiatingProcessCommandLine =~ \"-ExecutionPolicy Bypass -WindowStyle Hidden -E JAB\" and InitiatingProcessFileName =~ \"\\\\powershell.exe\" and ProcessCommandLine =~ \"--load-extension=\\\"*\\\\Appdata\\\\local\\\\chrome\\\"\" and InitiatingProcessFolderPath =~ \"\\\\chrome.exe\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the creation of a new PowerShell module \".psm1\", \".psd1\", \".dll\", \".ps1\", etc. Topic: file_event_win_powershell_module_creation"}, {"role": "assistant", "content": "DeviceFileEvents\n| where (FileName in~ (\"\\\\WindowsPowerShell\\\\Modules\\\\\", \"\\\\PowerShell\\\\7\\\\Modules\\\\\")) and (InitiatingProcessFolderPath in~ (\"\\\\powershell.exe\", \"\\\\pwsh.exe\"))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detect use of scrobj.dll as this DLL looks for the ScriptletURL key to get the location of the script to execute Topic: registry_set_persistence_scrobj_dll"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey endswith \"InprocServer32\\\\(Default)\" and RegistryValueData =~ \"C:\\\\WINDOWS\\\\system32\\\\scrobj.dll\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects filename indicators that contain a specific typo seen used by the Small Sieve malware. Topic: file_event_win_malware_small_sieve_evasion_typo"}, {"role": "assistant", "content": "DeviceFileEvents\n| where (FileName =~ \"Microsift\" and (FileName in~ (\"\\\\Roaming\\\\\", \"\\\\Local\\\\\"))) or FileName =~ \"\\\\AppData\\\\Local\\\\MicrosoftWindowsOutlookDataPlus.txt\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via CommandLine Topic: proc_creation_win_susp_web_request_cmd_and_cmdlets"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine in~ (\"[System.Net.WebRequest]::create\", \"curl \", \"Invoke-RestMethod\", \"Invoke-WebRequest\", \"iwr \", \"Net.WebClient\", \"Resume-BitsTransfer\", \"Start-BitsTransfer\", \"wget \", \"WinHttp.WinHttpRequest\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects Certify a tool for Active Directory certificate abuse based on PE metadata characteristics and common command line arguments. Topic: proc_creation_win_hktl_certify"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where (FolderPath endswith \"\\\\Certify.exe\" or ProcessVersionInfoOriginalFileName =~ \"Certify.exe\" or ProcessVersionInfoFileDescription contains \"Certify\") or ((ProcessCommandLine in~ (\".exe cas \", \".exe find \", \".exe pkiobjects \", \".exe request \", \".exe download \")) and (ProcessCommandLine in~ (\" /vulnerable\", \" /template:\", \" /altname:\", \" /domain:\", \" /path:\", \" /ca:\")))"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects attempts to masquerade as legitimate files by adding a space to the end of the filename. Topic: proc_creation_macos_space_after_filename"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine endswith \" \" or InitiatingProcessFolderPath =~ \" \""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects changes to HKCU\\Software\\Classes\\Folder\\shell\\open\\command\\DelegateExecute Topic: registry_set_comhijack_sdclt"}, {"role": "assistant", "content": "DeviceRegistryEvents\n| where RegistryKey contains \"\\\\Software\\\\Classes\\\\Folder\\\\shell\\\\open\\\\command\\\\DelegateExecute\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects DLL sideloading activity seen used by Diamond Sleet APT Topic: image_load_apt_diamond_sleet_side_load"}, {"role": "assistant", "content": "DeviceImageLoadEvents\n| where (FolderPath endswith \":\\\\ProgramData\\\\Version.dll\" and InitiatingProcessFolderPath =~ \":\\\\ProgramData\\\\clip.exe\") or (FolderPath endswith \":\\\\ProgramData\\\\DSROLE.dll\" and InitiatingProcessFolderPath =~ \":\\\\ProgramData\\\\wsmprovhost.exe\")"}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n Topic: proc_creation_win_remote_access_tools_screenconnect"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessVersionInfoFileDescription =~ \"ScreenConnect Service\" or ProcessVersionInfoProductName =~ \"ScreenConnect\" or ProcessVersionInfoCompanyName =~ \"ScreenConnect Software\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects listing of the inodes of the \"/\" directory to determine if the we are running inside of a container. Topic: proc_creation_lnx_susp_inod_listing"}, {"role": "assistant", "content": "DeviceProcessEvents\n| where ProcessCommandLine endswith \" /\" and ((ProcessCommandLine contains \" -\" and ProcessCommandLine contains \"i\") or (ProcessCommandLine contains \" -\" and ProcessCommandLine contains \"d\")) and InitiatingProcessFolderPath =~ \"/ls\""}]}
{"messages": [{"role": "system", "content": "You are an expert in creating Kusto Query Language (KQL) queries. You are given a description and you will output the KQL query"}, {"role": "user", "content": "Detects potential DLL sideloading of \"waveedit.dll\", which is part of the Nero WaveEditor audio editing software. Topic: image_load_side_load_waveedit"}, {"role": "assistant", "content": "DeviceImageLoadEvents\n| where FolderPath endswith \"\\\\waveedit.dll\" and (not(((InitiatingProcessFolderPath in~ (\"C:\\\\Program Files (x86)\\\\Nero\\\\Nero Apps\\\\Nero WaveEditor\\\\waveedit.exe\", \"C:\\\\Program Files\\\\Nero\\\\Nero Apps\\\\Nero WaveEditor\\\\waveedit.exe\")) and (FolderPath startswith \"C:\\\\Program Files (x86)\\\\Nero\\\\Nero Apps\\\\Nero WaveEditor\\\\\" or FolderPath startswith \"C:\\\\Program Files\\\\Nero\\\\Nero Apps\\\\Nero WaveEditor\\\\\"))))"}]}
